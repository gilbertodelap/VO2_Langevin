#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrbook
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package babel
\inputencoding auto
\fontencoding default
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format default
\output_sync 1
\output_sync_macro "\synctex=-1"
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref section
\pdf_pdfusetitle true
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 0
\use_package cancel 0
\use_package esint 2
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 1
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
xSPDE: The Stochastic Toolbox 
\begin_inset Newline newline
\end_inset

User's Guide v3.2
\end_layout

\begin_layout Author
Peter D.
 Drummond, Rodney Polkinghorne, Simon Kiesewetter
\end_layout

\begin_layout Address

\series bold
Centre for Quantum and Optical Science, Swinburne University of Technology,
 Melbourne, Victoria, Australia.
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Chapter
Introduction
\begin_inset CommandInset label
LatexCommand label
name "chap:Introduction"

\end_inset


\end_layout

\begin_layout Standard
The xSPDE stochastic toolbox is an e
\series bold
x
\series default
tensible 
\series bold
S
\series default
tochastic 
\series bold
P
\series default
artial 
\series bold
D
\series default
ifferential 
\series bold
E
\series default
quation solver.
 It can solve any number of simultaneous equations in any number of space
 dimensions, with averaging and graphical output.
 These equations include ordinary differential equations, partial differential
 equations with specified boundaries, stochastic equations and stochastic
 partial differential equations.
 This user's guide can be used as the basis for a 3-4 hour self-taught tutorial
 on solving differential and stochastic equations.
 Additionally, it includes exercises for the reader.
 A full-length manual is available online.
 Research use of this software is encouraged, and should be referenced to
 the corresponding paper
\begin_inset CommandInset citation
LatexCommand cite
key "Kiesewetter"
literal "true"

\end_inset

.
 See:
\emph on
 
\series bold
\emph default
www.github.com/peterddrummond/xspde_matlab.
\end_layout

\begin_layout Standard
Stochastic equations are equations with random noise terms 
\begin_inset CommandInset citation
LatexCommand cite
key "Gardiner,Drummond"
literal "true"

\end_inset

.
 They occur in in many fields of biology, chemistry, engineering, economics,
 physics, meteorology and other disciplines.
 The general equation solved can be written in differential form as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\mathbf{a}}{\partial t}=\mathbf{A}\left[\mathbf{a}\right]+\underline{\mathbf{B}}\left[\mathbf{a}\right]\cdot\bm{w}(t,\bm{x})+\underline{\mathbf{L}}\left[\bm{\nabla},\mathbf{a}\right]\,.
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is a vector, 
\begin_inset Formula $\underline{\mathbf{B}}$
\end_inset

 a matrix, 
\begin_inset Formula $\underline{\mathbf{L}}\left[\bm{\nabla},\mathbf{a}\right]$
\end_inset

 is a differential operator in arbitrary dimensional real space 
\begin_inset Formula $\bm{x}$
\end_inset

, and 
\begin_inset Formula $\mathbf{w}$
\end_inset

 is a noise vector, delta-correlated in time: 
\begin_inset Formula 
\begin{eqnarray}
\left\langle w_{i}\left(t,\mathbf{x}\right)w_{j}\left(t',\mathbf{x}'\right)\right\rangle  & = & \delta\left(t-t'\right)\delta\left(\bm{x}-\bm{x}'\right)\delta_{ij}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Oridinary and stochastic differential equations are described first.
 Stochastic partial differential equations including space dependence 
\begin_inset CommandInset citation
LatexCommand cite
key "DrummondMortimer,KP"
literal "true"

\end_inset

 are also numerically soluble with xSPDE.
 These are described in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Stochastic-partial-differential"

\end_inset

.
\end_layout

\begin_layout Standard
xSPDE is a Matlab based software toolbox.
 It has functions that can numerically solve both ordinary and partial different
ial stochastic equations, and graph results of correlations and averages.
 There are many equations of this type, and the xSPDE toolbox can treat
 a wide range.
 The extensible general structure permits drop-in replacements of the functions
 provided.
 Different simulations can be carried out sequentially, to simulate the
 various stages in an experiment or other process.
 It can even be used with no noise.
\end_layout

\begin_layout Standard
The code supports parallelism at both the vector instruction level and at
 the thread level, using Matlab matrix instructions and the parallel toolbox.
 It calculates averages of arbitrary functions of any number of complex
 or real fields, as well as Fourier transforms in time or space.
 It provides error estimates for both step-size and sampling error.
 
\end_layout

\begin_layout Standard

\emph on
xSPDE is distributed without any guarantee, under an open-source license.
 Contributions and bug reports always welcome.
\end_layout

\begin_layout Chapter
xSPDE simulations
\begin_inset CommandInset label
LatexCommand label
name "chap:Interactive-xSPDE"

\end_inset


\end_layout

\begin_layout Standard
The general purpose xSPDE toolbox function is:
\end_layout

\begin_layout Itemize

\series bold
xspde
\series default
, the combined simulation (xSIM) and graphics (xGRAPH) function.
\end_layout

\begin_layout Itemize
All required files are available in a toolbox: 
\begin_inset Formula $xspde.mltbx$
\end_inset

, or in a folder: xSPDE3.
\end_layout

\begin_layout Section
Running xSPDE interactively
\end_layout

\begin_layout Standard
The xSPDE code can be run interactively as a script, or as a function in
 batch mode, either at a local workstation or on a remote cluster.
 Data can be either plotted immediately, or saved then plotted later.
 To simulate a stochastic equation interactively, first check that the Matlab
 xSPDE toolbox is installed.
 
\end_layout

\begin_layout Standard

\series bold
If you have the toolbox file, 
\begin_inset Formula $xspde.mltbx$
\end_inset

, just open it and click on 
\begin_inset Formula $install$
\end_inset

.
 
\end_layout

\begin_layout Standard
Otherwise the Matlab path must pointing to the xSPDE folder and subfolders.
 If you have the folders, but not the toolbox, proceed as follows:
\end_layout

\begin_layout Itemize
Click on the Matlab HOME tab (top left), then Set Path
\end_layout

\begin_layout Itemize
Click on Add with Subfolders
\end_layout

\begin_layout Itemize
Find the xSPDE3 folder in the drop-down menu, and select it
\end_layout

\begin_layout Itemize
Click on close to save the path.
\end_layout

\begin_layout Standard
Next, type 
\begin_inset Formula $clear$
\end_inset

 to clear old data, and enter the xSPDE inputs and functions into the command
 window.
 For the simplest of examples, do this by cutting and pasting from an electronic
 file of this manual.
 You can also use the Matlab built-in editor.
\end_layout

\begin_layout Standard
A typical script first defines parameters and function specifications, in
 a structure, then runs the simulation code with the parameter structure
 as an input, as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\mathtt{r.}[label1] & = & [parameter1]\\
\mathtt{r.}[label2] & = & \ldots\\
\mathtt{r.da} & = & \mathtt{@(a,w,r)}\,\,[derivative]\\
\mathtt{xspde(r)}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Note the following points to remember:
\end_layout

\begin_layout Itemize
The notation 
\begin_inset Formula $\mathtt{r.}[label1]=[parameter1]$
\end_inset

 defines a parameter or function in the data structure 
\begin_inset Formula $r$
\end_inset

.
 
\end_layout

\begin_layout Itemize
There are many input possibilities, and they all have default values.
\end_layout

\begin_layout Itemize
You don't have to save the data if you just want an immediate plot 
\end_layout

\begin_layout Itemize
The notation 
\begin_inset Formula $\mathtt{r.da=}\mathtt{@(a,w,r)}\,\,[derivative]=..$
\end_inset

 defines an inline function, 
\begin_inset Formula $da/dt$
\end_inset

.
 
\end_layout

\begin_layout Itemize
In this example, 
\begin_inset Formula $\mathtt{a}$
\end_inset

 is the stochastic variable, 
\begin_inset Formula $\mathtt{w}$
\end_inset

 the random noise, and 
\begin_inset Formula $\mathtt{r}$
\end_inset

 the internal data structure.
 
\end_layout

\begin_layout Itemize
For example, 
\begin_inset Formula $\mathtt{r.t}$
\end_inset

 is the current time, and 
\begin_inset Formula $\mathtt{r.x},$
\end_inset

 
\begin_inset Formula $\mathtt{r.y},$
\end_inset

 
\begin_inset Formula $\mathtt{r.z},$
\end_inset

 the grid of coordinates.
 
\end_layout

\begin_layout Section
Inputs
\end_layout

\begin_layout Standard
All xSPDE simulations use a structure 
\emph on
in
\emph default
 for input data.
 All functions use an internally generated structure 
\begin_inset Formula $r$
\end_inset

, combining both 
\begin_inset Formula $in$
\end_inset

 and additional internally generated parameters.
 Any name will do for either structure, as long as you are consistent.
 
\end_layout

\begin_layout Standard
All xSPDE inputs have default values, which can be changed by typing parameters
 into the 
\emph on
in
\emph default
 structure.
 If you only need the first element of a vector or array, just input the
 value that is required, the remaining elements will be given their default
 value.
 All parameters used can be output using the documentation switch, 
\begin_inset Formula $\mathtt{print=1}$
\end_inset

.
\end_layout

\begin_layout Subsection
Common inputs
\end_layout

\begin_layout Standard
The most common xSPDE input parameters are: 
\begin_inset Newline newline
\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="20" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
fields
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stochastic field variables
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
noises
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of noises
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dimension
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space-time dimensions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
name
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
string 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
' ' 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simulation name
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
olabels
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
string
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
'a'
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
da
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The stochastic derivative
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
define
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defined field definition
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
initial
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Function to initialize variables
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ensembles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[1,1,1]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Numbers of stochastic trajectories
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
observe
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable function(s) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
linear
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Linear interaction picture function
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ranges
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[10,10,..
 ]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ranges in time and space
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
steps
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[1]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Intermediate steps per time point
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
points
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[51,35,..] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output lattice points in [t,x,y,z]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
probability
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cell array of vectors
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binning ranges for probabilities
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
images
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer cell array
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{0,..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Movie images in time per 2D observable
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
transforms
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector cells 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {[0 0 0 0],..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set to 1 for Fourier transforms in [t,x,y,z]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
scatters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer cell array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {0,..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set to s for s scatter plots in the observable
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
print
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 0
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set to 1 for parameter outputs
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard

\series bold
A complete list of user inputs is given in Chapter (
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Table-of-xSPDE"

\end_inset

).
\end_layout

\begin_layout Subsection
Fields
\end_layout

\begin_layout Standard
The first concept to understand is the 
\emph on
fields
\emph default
 parameter.
 All stochastic variables are integrated as matrices.
 The first input data, 
\emph on
fields
\emph default
, is the range of the first index, which is the number of  variables or
 field components that are integrated.
 This has a default value of 
\begin_inset Formula $fields=1$
\end_inset

.
 If required, 
\emph on
fields 
\emph default
can have a second value, like 
\begin_inset Formula $[1,1]$
\end_inset

.
 The second index of 
\emph on
fields
\emph default
 gives the number of user defined auxiliary fields, which are sometimes
 required.
 These do not have a differential equation, but have a functional definition,
 and add to the number of field components available in equations or outputs.
 
\end_layout

\begin_layout Standard
Both types of fields are indexed by using the first index of the field variable,
 like 
\begin_inset Formula $a(i,j)$
\end_inset

.
 Index numbers 
\begin_inset Formula $i$
\end_inset

 greater than 
\begin_inset Formula $fields(1)$
\end_inset

 access the auxiliary fields, to give an extended vector of fields plus
 auxiliary fields.
 The second matrix index 
\begin_inset Formula $j$
\end_inset

 accesses all other aspects of the field, including space indices and an
 ensemble index when several equations are integrated in parallel.
 These can be unpacked to give a higher-dimensional field array.
 This is useful if one wishes to address all the space indices independently,
 but in most cases it is simply not necessary.
\end_layout

\begin_layout Subsection
Functions
\end_layout

\begin_layout Standard
The next concept to understand is the idea of a 
\emph on
function
\emph default
.
 All important functionality in xSPDE uses modular functions.
 Functions can be specifed inline, which is short and fast.
 An example of this is 
\begin_inset Formula $r.da=@(a,w,r)\,w$
\end_inset

 .
 This defines the function 
\begin_inset Formula $da$
\end_inset

, which gives the stochastic derivative function.
 In this example, it simply returns the input value 
\begin_inset Formula $w.$
\end_inset

 This user specified inline function is then known internally by the function
 handle 
\begin_inset Formula $r.da$
\end_inset

.
 Alternatively, external function handles can be used to define modular
 Matlab codes.
 This is available for complex functions that might have internal logic.
 
\end_layout

\begin_layout Subsection
Observables
\end_layout

\begin_layout Standard
The final concept to understand is the idea of an 
\emph on
observable
\emph default
.
 In a stochastic calculation there are many different averages that might
 be needed, from the fields themselves to moments, correlations, spectra,
 or maybe even more complex quantities.
 These are calculated internally and stored.
 One can also store the raw trajectories, but this is usually a very costly
 exercise in terms of memory.
 The functions that define what is averaged internally are called the 
\begin_inset Formula $observe$
\end_inset

 functions.
 Once data is averaged internally, further functional transforms and plots
 of the averages are available.
\end_layout

\begin_layout Subsection
Use the dot
\end_layout

\begin_layout Standard
Matlab formulae often require a 'dot' or a 'colon'.
 To multiply vectors element-wise, like 
\begin_inset Formula $a_{i}=b_{i}c_{i}$
\end_inset

, the notation 
\begin_inset Formula $a=b.*c$
\end_inset

 indicates all elements are multiplied.
 This is used in xspde to speed up calculations in parallel.
 
\end_layout

\begin_layout Standard
A formula for a stochastic field typically requires you to address the first
 index - which is the field component - and treat all the other elements
 in parallel.
 To do this, use the notation 
\begin_inset Formula $a(1,:)$
\end_inset

.
 The colon indicates that all the second index elements are being addressed
 in parallel
\end_layout

\begin_layout Standard
Whenever a formula combines operations over spatial lattices or ensembles,
 remember to 
\series bold
USE THE DOT
\series default
.
\end_layout

\begin_layout Section
Random walk
\end_layout

\begin_layout Standard
The first example is the simplest possible stochastic equation: 
\begin_inset Formula 
\begin{equation}
\dot{a}=w(t)\,,
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This is carried out numerically and graphed using 
\begin_inset Formula $N=points(1)$
\end_inset

 points.
 Since the first time point stored is always the initial value, there are
 
\begin_inset Formula $N-1$
\end_inset

 integration steps, each of length 
\begin_inset Formula $dt=ranges(1)/(N-1)$
\end_inset

.
 As a result, the graphs have discrete steps, and more detail is obtained
 if more time steps are used.
 The default value is 
\begin_inset Formula $N=51$
\end_inset

, which is in the 
\begin_inset Formula $xpreferences$
\end_inset

 file.
 This is adjustable by the user.
 It can also be changed for a simulation, by inputting a new value of 
\begin_inset Formula $points$
\end_inset

.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Standard
Unless you type 
\emph on
clear
\emph default
 first, any changes to the input structure are additive; so you will get
 the sum of all the previous inputs as well as your new input.
 
\end_layout

\begin_layout Itemize

\series bold
Run the complete xSPDE script given below in Matlab.
 
\end_layout

\begin_layout Standard
It is simplest to cut and paste from an electronic file into the Matlab
 command window.
 Be careful; pasting can cause subtle changes that may require correction.
 Some generated characters may be invalid Matlab input characters, and these
 will need retyping.
\end_layout

\begin_layout Standard
You should get the output in Fig (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-simplest-case: Wiener"

\end_inset

).
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
r.
\family typewriter
da=@(a,w,r) w; xspde(
\family default
r)
\family typewriter
;
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
Here 
\begin_inset Formula $r.da$
\end_inset

 defines the time derivative function 
\begin_inset Formula $\dot{a}$
\end_inset

, with 
\begin_inset Formula $w$
\end_inset

 being the delta-correlated Gaussian noise that is generated internally.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset


\begin_inset Graphics
	filename ../../xspde_matlab3.1/users guide/Figures/Wiener_1.pdf
	width 75text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:The-simplest-case: Wiener"

\end_inset

The simplest case: a random walk.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
What do you see if you average over 
\begin_inset Formula $10000$
\end_inset

 trajectories ?
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
r.
\family typewriter
ensembles = 10000;
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(
\family default
r)
\family typewriter
;
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
What do you see if you plot the mean square distance? Note that variances
 should increase linearly with 
\begin_inset Formula $t$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
r.
\family typewriter
observe = @(a,r) a.^2;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels = '<a^2>';
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(
\family default
r)
\family typewriter
;
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
What if you add a force that takes the particle back to the origin?
\series default
 
\begin_inset Formula 
\begin{equation}
\dot{a}=-a+w(t)\,,
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
r.
\family typewriter
da=@(a,w,r) -a+w;
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(
\family default
r)
\family typewriter
;
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*

\series bold
Mathematical exercise:
\series default
 
\end_layout

\begin_layout Itemize
As an offline exercise, try to solve the equivalent diffusion equation for
 the probability P to find the variance 
\begin_inset Formula $\left\langle a^{2}\right\rangle $
\end_inset

! The equation is:
\begin_inset Formula 
\[
\frac{\partial P\left(a\right)}{\partial t}=\left[\frac{\partial}{\partial a}+\frac{1}{2}\frac{\partial^{2}}{\partial a^{2}}\right]P\left(a\right)
\]

\end_inset


\end_layout

\begin_layout Section
Laser quantum noise
\end_layout

\begin_layout Standard
Next we treat a model for the quantum noise of a single mode laser as it
 turns on, near threshold:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{a}=ga+bw(t)
\end{equation}

\end_inset

where the noise is complex, 
\begin_inset Formula $w=\left(w_{1}+iw_{2}\right)$
\end_inset

, so that: 
\begin_inset Formula 
\begin{equation}
\left\langle w(t)w^{*}(t')\right\rangle =2\delta\left(t-t'\right)\,.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Here the coefficient 
\begin_inset Formula $b$
\end_inset

 describes the quantum noise of the laser, and is inversely proportional
 to the equilibrium photon number.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Standard
You should type 
\emph on
clear 
\emph default
first when starting new simulations.
\end_layout

\begin_layout Itemize

\series bold
Solve for the case of 
\begin_inset Formula $g=0.1$
\end_inset

, 
\begin_inset Formula $b=0.01$
\end_inset


\end_layout

\begin_layout Standard
Most lasers have more than 
\begin_inset Formula $100$
\end_inset

 photons, and hence less noise! 
\end_layout

\begin_layout Standard
For this exercise, small error-bars will display on the graph.
 These are calculated from the difference between using steps of size 
\begin_inset Formula $dt$
\end_inset

 and steps of size 
\begin_inset Formula $dt/2$
\end_inset

.
 They only appear if greater than a minimum relative size, typically 
\begin_inset Formula $1\%$
\end_inset

 of the graph size, which can be set by the user.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
clear
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
noises=2;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
observe = @(a,r) abs(a)^2;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels = '|a|^2';
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
da=@(a,w,r) a+0.01*(w(1)+i*w(2));
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(
\family default
r)
\family typewriter
;
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Consider the case where the laser saturates to a steady state:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{a}=\left(1-\left|a\right|^{2}\right)a+bw(t)
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Solve for the saturated laser case
\end_layout

\begin_layout Standard
You should get the output graph in Fig (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-laser"

\end_inset

).
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
r.
\family typewriter
da=@(a,w,r) (1-abs(a)^2)*a+0.01*(w(1)+i*w(2));
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(
\family default
r)
\family typewriter
;
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset


\begin_inset Graphics
	filename ../../xspde_matlab3.1/users guide/Figures/Laser.pdf
	width 75text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:The-laser"

\end_inset

Simulation of the stochastic equation describing a laser turning on.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Fourier transforms
\end_layout

\begin_layout Standard
Frequency spectra have many uses, especially for understanding the steady-state
 fluctuations of any physical system.
 The xSPDE spectral definition is:
\begin_inset Formula 
\[
\tilde{a}(\omega)=\frac{1}{\sqrt{2\pi}}\int e^{-i\omega t}a(t)dt\,
\]

\end_inset


\end_layout

\begin_layout Standard
To get an output from a temporally Fourier transformed field, just set 
\begin_inset Formula $transforms\{n\}=1$
\end_inset

, for the particular observable (
\begin_inset Formula $n$
\end_inset

) you need to calculate in transform space.
 This parameter is a cell array.
 It can have a different value for every observable and for every dimension
 in space-time if you have space dimensions as well.
\end_layout

\begin_layout Standard
As an example, take the random walk equation in a complex space, 
\begin_inset Formula 
\[
\frac{da}{dt}=-a+\zeta(t)
\]

\end_inset

where 
\begin_inset Formula $\zeta(t)=w_{1}(t)+iw_{2}(t)$
\end_inset

.
 Use an initial condition of 
\begin_inset Formula $a=(v_{1}+iv_{2})/\sqrt{2}$
\end_inset

, with 
\begin_inset Formula $\left\langle v_{i}^{2}\right\rangle =1$
\end_inset

, to start near the steady state.
 
\end_layout

\begin_layout Standard
For sufficiently long time-intervals, the solution in frequency space -
 where 
\begin_inset Formula $\omega=2\pi f$
\end_inset

 is the angular frequency - is given by: 
\begin_inset Formula 
\[
\tilde{a}\left(\omega\right)=\frac{\tilde{\zeta}(\omega)}{1+i\omega}
\]

\end_inset

The expectation value of the noise spectrum, in the long time-intervals
 limit, is therefore: 
\begin_inset Formula 
\begin{eqnarray*}
\left\langle \left|\tilde{a}(\omega)\right|^{2}\right\rangle  & = & \frac{1}{2\pi\left(1+\omega^{2}\right)}\int\int e^{-i\omega(t-t')}\left\langle \zeta(t)\zeta^{*}(t')\right\rangle dtdt'\,.\\
 & = & \frac{T_{eff}}{\pi\left(1+\omega^{2}\right)}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
The final result is obtained from the fact that the first integral vanishes
 unless 
\begin_inset Formula $t=t'$
\end_inset

, since for small steps, 
\begin_inset Formula $\left\langle \zeta(t)\zeta^{*}(t')\right\rangle \rightarrow2\delta\left(t-t'\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
The time integral is carried out numerically as a sum which has 
\begin_inset Formula $N=points(1)$
\end_inset

 time points of interval 
\begin_inset Formula $dt$
\end_inset

.
 The definition of 
\begin_inset Formula $dt$
\end_inset

 is therefore 
\begin_inset Formula $dt=T/(N-1)$
\end_inset

, where 
\begin_inset Formula $T=ranges(1)$
\end_inset

.
 The `effective' time duration for the Fourier transform time integrals
 is 
\begin_inset Formula $T_{eff}=Ndt=T\times N/(N-1)=T+dt$
\end_inset

.
 This corresponds to a midpoint rule integration, which technically is over
 the interval 
\begin_inset Formula $[-dt/2,T+dt/2]$
\end_inset

.
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Plot the spectrum over a range of 
\begin_inset Formula $t=100$
\end_inset

, with 
\begin_inset Formula $640$
\end_inset

 points and a random initial equation near the equilibrium value.
\end_layout

\begin_layout Standard
The input parameters are given below.
 There are parallel operations here, for ensemble averaging, so 
\series bold
USE THE DOT
\series default
.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
clear
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
points = 640;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
ranges = 100;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
noises = 2; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
ensembles = 10000; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
initial = @(v,r) (v(1,:)+1i*v(2,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
da = @(a,w,r) -a + w(1,:)+1i*w(2,:); 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
observe =@(a,r) a.*conj(a);
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
transforms =1;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels = '|a(
\backslash
omega)|^2'; 
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(
\family default
r)
\family typewriter
; 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
Note that r.
\family typewriter
transforms =1
\family default
 tells xSPDE to Fourier transform the field over the time coordinate before
 averaging, to give a spectrum.
 The first argument 
\begin_inset Formula $v$
\end_inset

 of the 
\emph on
initial
\emph default
 function is a random field, used optionally to initialize the stochastic
 variable.
 You can transform any field in any dimension, for any number of resulting
 averages.
 See Chapter 6 for details.
 
\end_layout

\begin_layout Standard
To define as many observables as you like, use a Matlab cell array; 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
r.
\family typewriter
observe{1} = ..;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
observe{2} = ..;
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Simulate over a range of 
\begin_inset Formula $t=200$
\end_inset

.
 What changes do you see? Why?
\end_layout

\begin_layout Itemize

\series bold
Change the equation to the laser noise equations.
 Why is the spectrum much narrower?
\end_layout

\begin_layout Section
Probability density
\end_layout

\begin_layout Standard
It is possible to graph probability densities of a real observable.
 This is achieved through specifying the observable and the binning ranges,
 by inputting:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
r.probability\{n\}=o1:ostep:o2;
\]

\end_inset


\end_layout

\begin_layout Standard
If present, this returns probability density of variable 
\begin_inset Formula $o(n)$
\end_inset

, through binning into ranges of width 
\begin_inset Formula $ostep$
\end_inset

 around centers starting at 
\begin_inset Formula $\text{\emph{o1}}$
\end_inset

, and ending at 
\begin_inset Formula $o2$
\end_inset

.
 Returns a result of 
\begin_inset Formula $1/ostep$
\end_inset

 in the 
\begin_inset Formula $j-th$
\end_inset

 bin if the trajectory is inside the bin, so that 
\begin_inset Formula $o(j)-ostep/2<o<o(j)+ostep/2$
\end_inset

, and zero otherwise.
 This gives a probability graph on output, plotted against time.
 Note that on graphing, an extra dimension is added for the variable 
\begin_inset Formula $o$
\end_inset

.
 Only probabilities of one-dimensional real variables are plotted, for interface
 simplicity.
 The probability can be for any function of the stochastic variable if required.
\end_layout

\begin_layout Standard
The 
\emph on
xgraph
\emph default
 program provides facilities for extracting slices and windows of the probabilit
ies where required.
 To plot the probabilities in the first observable for a range of 0:1, add
 the following input before the 
\emph on
xsim
\emph default
 or 
\emph on
xspde
\emph default
 command:
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
r.probability{1}=0:0.1:1.01;
\end_layout

\end_inset


\end_layout

\begin_layout Section
Ito and Stratonovich
\end_layout

\begin_layout Standard
The xSPDE toolbox is mainly designed to treat Stratonovich equations 
\begin_inset CommandInset citation
LatexCommand cite
key "Gardiner"
literal "true"

\end_inset

, which are the broad-band limit of a finite band-width random noise equation.
 Another type of of stochastic equation is the Ito form, which is a limit
 where derivatives are evaluated at the start of each step.
 If you have an Ito equation, you can either use the Euler integration option,
 and set 
\begin_inset Formula $r.step=xEuler$
\end_inset

, or else apply the Stratonovich correction to the drift, as outlined below.
 
\end_layout

\begin_layout Standard
To emphasize the difference, an Ito equation is often written as a difference
 equation:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
d\mathbf{a}=\mathbf{A}^{I}\left[\mathbf{a}\right]+\underline{\mathbf{B}}\left[\mathbf{a}\right]\cdot d\bm{w}(t).
\end{equation}

\end_inset

Here 
\begin_inset Formula $\left\langle dw_{i}\left(\bm{x}\right)dw_{j}\left(\bm{x}'\right)\right\rangle =\delta_{ij}dt$
\end_inset

.
 
\end_layout

\begin_layout Standard
When 
\begin_inset Formula $\bm{\mathsf{B}}$
\end_inset

 is constant, the two methods are identical.
 If 
\begin_inset Formula $\bm{\mathsf{B}}$
\end_inset

 is not constant, the Ito drift term 
\begin_inset Formula $\mathbf{A}^{I}$
\end_inset

 is different to the corresponding Stratonovich one.
 The relationship is: 
\begin_inset Formula 
\begin{eqnarray}
A_{i} & = & A_{i}^{I}-\frac{1}{2}\sum_{j,m}\frac{\partial B_{ij}}{\partial a_{m}}B_{mj}\,.
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Section
Financial calculus
\end_layout

\begin_layout Standard
A well-known Ito stochastic equation is the Black-Scholes equation, used
 to price financial options.
 It describes the fluctuations in a stock value: 
\begin_inset Formula 
\begin{equation}
da=\mu a\,dt+a\sigma\,dw,
\end{equation}

\end_inset

where 
\begin_inset Formula $\left\langle dw^{2}\right\rangle =dt$
\end_inset

.
 Since the noise is multiplicative, the equation is different in Ito and
 Stratonovich forms of stochastic calculus.
 
\end_layout

\begin_layout Standard
The corresponding Stratonovich equation, as used in xSPDE for the standard
 default integration routine is: 
\begin_inset Formula 
\begin{equation}
\dot{a}=\left(\mu-\sigma^{2}/2\right)a+a\sigma w(t).
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve for a startup with a volatile stock having 
\begin_inset Formula $\mu=0.1,\,\sigma=1$
\end_inset

.
\end_layout

\begin_layout Standard
An interactive xSPDE script in Matlab is given below with an output graph
 in Fig (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-Black-Scholes"

\end_inset

), Note the spiky behaviour, typical of multiplicative noise, and also of
 the risky stocks in the small capitalization portions of the stock market.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
clear
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
initial=@(v,r) 1;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
da=@(a,w,r) -0.4*a+a*w;
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(
\family default
r)
\family typewriter
;
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset


\begin_inset Graphics
	filename ../../xspde_matlab3.1/users guide/Figures/Black-Scholes.pdf
	width 75text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:The-Black-Scholes"

\end_inset

Simulation of the Black-Scholes equation describing stock prices.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $r.initial$
\end_inset

 describes the initialization function.
 The first argument of 
\begin_inset Formula $@(v,r)$
\end_inset

 is 
\begin_inset Formula $v$
\end_inset

, an initial random variable with unit variance.
 
\emph on
The error-bars are estimates of step-size error
\emph default
.
 Errors can be reduced by using more time-steps.
\end_layout

\begin_layout Itemize

\series bold
Solve for a more mature stock having 
\begin_inset Formula $\mu=0.1,\,\sigma=0.1$
\end_inset

.
\end_layout

\begin_layout Chapter
xSPDE projects 
\begin_inset CommandInset label
LatexCommand label
name "chap:Projects-xSPDE"

\end_inset


\end_layout

\begin_layout Standard
Projects are larger scale investigations, where files are used to record
 inputs and data.
 This requires a new input parameter:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
r.
\emph on
file
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
string 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
''
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Matlab or HDF5 data file
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Section
Ensembles and errors
\end_layout

\begin_layout Standard
Averages over stochastic ensembles are the specialty of xSPDE, which requires
 specification of the ensemble size.
 A sophisticated hierarchy of ensemble specifications in three levels is
 possible, to allow maximum resource utilization, so that:
\begin_inset Formula 
\[
r.ensembles=[ensembles(1),ensembles(2),ensembles(3)]\,.
\]

\end_inset

The local ensemble, 
\begin_inset Formula $ensembles\left(1\right)$
\end_inset

, gives within-thread parallelism, allowing vector instruction use for single-co
re efficiency.
 The serial ensemble, 
\begin_inset Formula $ensembles\left(2\right)$
\end_inset

, gives a number of independent trajectories calculated serially.
 
\end_layout

\begin_layout Standard
The parallel ensemble, 
\begin_inset Formula $ensembles\left(3\right)$
\end_inset

, gives multi-core parallelism, and requires the Matlab parallel toolbox.
 This improves speed when there are multiple cores.
 One should optimally put 
\begin_inset Formula $ensembles\left(3\right)$
\end_inset

 equal to the available number of CPU cores.
\end_layout

\begin_layout Standard
The 
\emph on
total 
\emph default
number of stochastic trajectories or samples is 
\begin_inset Formula 
\[
ensembles(1)\times ensembles(2)\times ensembles(3)\,.
\]

\end_inset


\end_layout

\begin_layout Standard
Either 
\begin_inset Formula $ensembles(2)$
\end_inset

 or 
\begin_inset Formula $ensembles(3)$
\end_inset

 are required if sampling error-bars are to be calculated, owing to the
 sub-ensemble averaging method used in xSPDE to calculate sampling errors
 accurately.
 
\end_layout

\begin_layout Section
xSIM and xGRAPH
\end_layout

\begin_layout Standard
An XPDE session can either run simulations interactively, described in Chapter
 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Interactive-xSPDE"

\end_inset

, or else using a function file called a project file.
 This allows xSPDE to run in a batch mode, as needed for longer projects
 which involve large ensembles.
 In either case, the Matlab path must include the xSPDE folder.
 For generating graphs automatically, the script input or project function
 should end with the combined function 
\series bold
xspde
\series default
.
 
\end_layout

\begin_layout Standard
With batch jobs it is often useful to divide xSPDE into its simulation function,
 xSIM, and its graphics function, xGRAPH, to allow graphs to be made at
 a later time from the simulation.
 In this case the function
\series bold
 
\begin_inset Formula $xsim$
\end_inset


\series default
 runs the simulation, and 
\begin_inset Formula $xgraph$
\end_inset

 makes the graphs.
 The two-stage option is better for running batch jobs, which you can graph
 at a later time.
\end_layout

\begin_layout Standard
To create a data file, you must enter the filename when running the simulation,
 using the 
\begin_inset Formula $r.file=filename$
\end_inset

 input.
 A typical xSPDE project function of this type is as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\mathtt{function}\,[e,ec] & = & project.m\\
\mathtt{r.}[label1] & = & [parameter1];\\
\mathtt{r.}[label2] & = & \ldots;\\
\mathtt{r.file} & = & '[my\,file].\mathtt{mat'};\\
\mathtt{[e,r]} & = & \mathtt{xsim(r)};\\
\mathtt{ec} & = & \mathtt{xgraph(r.file)};\\
\mathtt{end}
\end{eqnarray*}

\end_inset

After preparing a project file using the editor, click on the Run arrow
 above the editor window.
 
\end_layout

\begin_layout Standard
A batch job workflow is as follows:
\end_layout

\begin_layout Itemize
Create the metadata 
\begin_inset Formula $r$
\end_inset

, and include a file name, 
\begin_inset Formula $r.file$
\end_inset

.
\end_layout

\begin_layout Itemize
Change the Matlab directory path to home using 
\begin_inset Formula $cd\,\sim$
\end_inset

.
\end_layout

\begin_layout Itemize
Run the simulation with
\series bold
 [e,r]=xsim(
\series default
r), or just 
\series bold
xsim(
\series default
r);.
\end_layout

\begin_layout Itemize
Note: xsim changes the file-name if it already exists, and returns the new
 name for plotting!
\end_layout

\begin_layout Itemize
Run 
\series bold
xgraph(
\series default
r.
\series bold
file)
\series default
, or 
\series bold
xgraph(
\series default
r.
\series bold
file,r)
\series default
 if you want to edit the inputs in the structure 
\begin_inset Formula $r$
\end_inset

, and the data will be graphed.
 
\end_layout

\begin_layout Itemize
You can use either Matlab (.mat) or standard HDF5 (.h5) file-types.
\end_layout

\begin_layout Section
Kubo project
\end_layout

\begin_layout Standard
To get started on more complex programs, we next simulate the Kubo oscillator,
 which is an oscillator with a random frequency: 
\begin_inset Formula 
\begin{equation}
\dot{a}=iaw
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Simulate the Kubo oscillator using a file, 
\begin_inset Formula $Kubo.m$
\end_inset

, with two ensembles to allow sampling error estimates.
 The error vector 
\begin_inset Formula $error$
\end_inset

 gives the time-step error plus the sampling error.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [error] = Kubo() 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
name = 'Kubo oscillator';
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
ensembles = [400,16]; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
initial = @(v,r) 1+0*v;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
da = @(a,w,r) i*a.*w;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels = {'<a_1>'};
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
file = 'kubo.mat';
\end_layout

\begin_layout Plain Layout

\family typewriter
[error,r]=xsim(
\family default
r)
\family typewriter
; 
\end_layout

\begin_layout Plain Layout

\family typewriter
xgraph(
\family default
r.
\family typewriter
file);
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The initial value of 1 is modified by adding 
\begin_inset Formula $0*v$
\end_inset

.
 This is necessary, so that it returns an array whose first dimension equals
 the ensemble size.
 
\end_layout

\begin_layout Standard
This function is designed to generate a data file, 
\family typewriter
kubo.mat
\family default
.
 If you run this more than once without deleting the earlier file, you will
 get a warning and a new file-name, 
\family typewriter
kubo1.mat
\family default
, which is stored in the in structure.
 Under these circumstance, xGRAPH will graph the data in the most recent
 file saved, with the new file-name.
 This occurs because xSPDE will 
\series bold
not
\series default
 overwrite old files, to protect your previous data.
 
\end_layout

\begin_layout Standard
You can also include modified graphics parameters as a second input when
 running 
\family typewriter
xGRAPH, 
\family default
just in case the first graphs you generate need changes.
\end_layout

\begin_layout Section
Challenge problem #1
\end_layout

\begin_layout Standard
This is a harder example, involving a full nonlinear quantum phase-space
 simulation.
 The method can also be used to investigate quantum non-equilibrium phase
 transitions, tunneling in open systems, quantum entanglement, Einstein-Podolsky
-Rosen paradoxes, Bell violations, and many other problems treated in the
 literature
\begin_inset CommandInset citation
LatexCommand cite
key "Gardiner,Drummond"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
The following new ideas are introduced: 
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{ranges}$
\end_inset

 is the space-time integration range.

\series default
 
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{steps}$
\end_inset

 gives integration steps per time point, for increased accuracy.

\series default
 
\end_layout

\begin_layout Standard
A simple case is the nonlinear driven quantum `time crystal' or subharmonic
 generator - for example, an optomechanical, superconducting or nonlinear
 optical medium in a driven cavity.
 
\end_layout

\begin_layout Standard
This has a Stratonovich equation, which is the form treated by the xspde
 software:
\begin_inset Formula 
\begin{align*}
\frac{da_{1}}{d\tau} & =-(c+\frac{1}{2})a_{1}+a_{2}\lambda\left[1-a_{1}^{2}\right]+\sqrt{1-a_{1}^{2}}\eta_{1}\left(\tau\right)\\
\frac{da_{2}}{d\tau} & =-(c+\frac{1}{2})a_{2}+a_{1}\lambda\left[1-a_{2}^{2}\right]+\sqrt{1-a_{2}^{2}}\eta_{2}\left(\tau\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
There is a bistable region, which leads to a discrete time symmetry breaking.
 The solution in the steady-state is
\begin_inset Formula 
\[
P=\left(1-a_{1}^{2}\right)^{c}\left(1-a_{2}^{2}\right)^{c}e^{2\lambda a_{1}a_{2}}
\]

\end_inset


\end_layout

\begin_layout Standard
The integration manifold is the region of real 
\begin_inset Formula $a_{1}$
\end_inset

, 
\begin_inset Formula $a_{2}$
\end_inset

, such that 
\begin_inset Formula $a_{1}^{2}\le1$
\end_inset

 , 
\begin_inset Formula $a_{2}^{2}\le1$
\end_inset

.
 There are two physically possible metastable values of the amplitudes.
 The physically observed quantity is the amplitude and number:
\begin_inset Formula 
\begin{align*}
\left\langle \hat{a}\right\rangle  & =\frac{1}{2}\left\langle a_{1}+a_{2}\right\rangle \\
\left\langle \hat{n}\right\rangle  & =\left\langle a_{1}a_{2}\right\rangle 
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Typical parameters that show bistable behaviour are 
\begin_inset Formula $c=1$
\end_inset

, 
\begin_inset Formula $\lambda=4$
\end_inset

.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Simulate the nonlinear oscillator by creating a file, 
\begin_inset Formula $Nonlinear.m$
\end_inset

 
\end_layout

\begin_layout Itemize

\series bold
Can you observe quantum tunneling in the bistable regime?
\end_layout

\begin_layout Itemize

\series bold
Do you see transient Schrodinger `cat states' with a negative n value?
\end_layout

\begin_layout Standard
Since tunneling is random, for real experimental comparisons, one would
 have to measure correlation functions and spectra.
 However, a tunneling event in a simulation indicates that it is likely
 in experiment too.
 These calculations require long time scales, 
\begin_inset Formula $\mathtt{in.ranges}$
\end_inset

, to observe tunneling, and a large number of time steps per plotted time
 point, 
\begin_inset Formula $\mathtt{in.steps}$
\end_inset

, to maintain accuracy in the quantum simulations.
\end_layout

\begin_layout Chapter
Stochastic PDEs
\begin_inset CommandInset label
LatexCommand label
name "chap:Stochastic-partial-differential"

\end_inset


\end_layout

\begin_layout Standard
A stochastic partial differential equation or 
\begin_inset Formula $SPDE$
\end_inset

 for a complex vector field is defined in both time 
\begin_inset Formula $t$
\end_inset

 and space dimensions
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $\bm{x}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
.
 The total number of 
\begin_inset Formula $fields$
\end_inset

 or internal indices is unlimited.
 The total space-time 
\emph on
dimension,
\emph default
 
\begin_inset Formula $D$
\end_inset

 in xSPDE is also unlimited.
 It includes time (
\begin_inset Formula $D=1)$
\end_inset

 and space (
\begin_inset Formula $D>1$
\end_inset

).
 Large numbers of space-time dimensions are memory-intensive and slow, with
 a currently practical limit of about 
\begin_inset Formula $D=6$
\end_inset

 unless you have a very large memory and fast computer!
\end_layout

\begin_layout Standard
The general equation solved can be written in differential form as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\mathbf{a}}{\partial t}=\mathbf{A}\left[\mathbf{a}\right]+\underline{\mathbf{B}}\left[\mathbf{a}\right]\cdot\bm{w}(t)+\underline{\mathbf{L}}\left[\bm{\nabla},\mathbf{a}\right]\,.
\end{equation}

\end_inset

Here 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is a real or complex vector field, with 
\begin_inset Formula $'fields'$
\end_inset

 components, and 
\begin_inset Formula $\bm{w}=\left[\bm{w}^{x},\bm{w}^{k}\right]$
\end_inset

 is a random field, with 
\begin_inset Formula $'noises'$
\end_inset

 components.
 This is a vector such that: 
\begin_inset Formula $noises(1)$
\end_inset

' is the number of x-correlated noises,
\begin_inset Formula $\bm{w}^{x}$
\end_inset

, and 
\begin_inset Formula $noises(2)$
\end_inset

' is the number of k-correlated noises, 
\begin_inset Formula $\bm{w}^{k}$
\end_inset

.
 These correlations are user-adjustable, explained below.
 
\end_layout

\begin_layout Standard
Initial conditions are set at the initial time of 
\begin_inset Formula $t=o_{1}$
\end_inset

 with a user-defined function so that:
\begin_inset Formula 
\[
a(o_{1})=initial(v,r)
\]

\end_inset

The 
\emph on
initial
\emph default
 function includes 
\begin_inset Formula $'randoms'$
\end_inset

 initial random fields 
\begin_inset Formula $v=\left[v^{x},v^{k}\right]$
\end_inset

.
 Their correlations are also defined either in x-space or in k-space.
 To allow this, the input parameter 
\begin_inset Formula $'randoms'$
\end_inset

 is a vector such that: 
\begin_inset Formula $'randoms(1)$
\end_inset

' is the number of x-correlated random fields,
\begin_inset Formula $v^{x}$
\end_inset

, and 
\begin_inset Formula $'randoms(2)$
\end_inset

' is the number of k-correlated random fields, 
\begin_inset Formula $v^{k}$
\end_inset

.
 All random fields in the 
\emph on
initial
\emph default
 function, even if defined with momentum correlations, are transformed to
 position space before use.
 If there is no scaling of the momentum noise, 
\begin_inset Formula $v^{x}$
\end_inset

 and 
\begin_inset Formula $v^{k}$
\end_inset

 have the same correlations.
\end_layout

\begin_layout Standard
Transverse 
\emph on
boundaries
\emph default
 are of three types: Neumann (specified derivative), periodic, or Dirichlet
 (specified field).
 These are indicated using 
\begin_inset Formula $boundaries=-1,0,1$
\end_inset

, which can be specified for each space dimension, field index and boundary,
 as explained below in greater detail.
\end_layout

\begin_layout Standard
The spatial derivatives or other functions linking different spatial points
 can be specified either in the functions 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

, or else in the 
\begin_inset Formula $linear$
\end_inset

 function, if the derivative terms are linear functions of the fields.
 Use of the 
\begin_inset Formula $linear$
\end_inset

 function allows an interaction picture algorithm, with increased efficiency.
 Currently, the 
\begin_inset Formula $linear$
\end_inset

 function is only available in conjunction with a Fourier transform propagator.
\end_layout

\begin_layout Section
Coordinates and indices
\end_layout

\begin_layout Standard
The spatial interval used is from a preset input 
\emph on
origin
\emph default
 
\begin_inset Formula $\bm{o}$
\end_inset

, and has predetermined input 
\emph on
ranges
\emph default
 
\begin_inset Formula $\mathbf{r}$
\end_inset

.
 If the 
\emph on
origin
\emph default
 or the 
\emph on
ranges
\emph default
 are not input, they have default values.
 The default origin of the first (time) coordinate starts at 
\begin_inset Formula $t=0$
\end_inset

.
 Spatial coordinates have default origins that give symmetric intervals,
 with the origin at 
\begin_inset Formula $-\mathbf{r}/2$
\end_inset

.
 Dimensions are indexed with the first (time) dimension as 
\begin_inset Formula $i=1$
\end_inset

.
 As an example, for the x-dimension, the problem is solved on an interval
 of 
\begin_inset Formula $x=[o_{2},o_{2}+r_{2}]$
\end_inset

, with a default of 
\begin_inset Formula $x=[-r_{2}/2,r_{2}/2].$
\end_inset


\end_layout

\begin_layout Paragraph*
In order to discretize the problem for solution the 
\begin_inset Formula $n_{i}$
\end_inset

 lattice 
\emph on
points
\emph default
 are fitted into the spatial interval so that 
\begin_inset Formula $dx_{i}=r_{i}/(n_{i}-1)$
\end_inset

, ie:
\begin_inset Formula 
\begin{equation}
x_{i}=o_{i}+(i-1)dx_{i}\,.
\end{equation}

\end_inset

Stochastic data
\end_layout

\begin_layout Standard
To store stochastic data like field variables that are used in the stochastic
 equations, the following convention is always used.
 The logical array index ordering is 
\begin_inset Formula $fields(i,\mathbf{j},e)$
\end_inset

, where: 
\end_layout

\begin_layout Itemize
The first index is a field index (
\begin_inset Formula $i$
\end_inset

).
\end_layout

\begin_layout Itemize
The 
\begin_inset Formula $d$
\end_inset

 indices 
\begin_inset Formula $j_{1},\ldots j_{d}\equiv\bm{j}$
\end_inset

 are for time and space, or momentum space if Fourier transformed.
\end_layout

\begin_layout Itemize
The last index is an ensembles index (
\begin_inset Formula $e$
\end_inset

), used to index over field trajectories.
\end_layout

\begin_layout Itemize
For storing space coordinates like 
\begin_inset Formula $r.x$
\end_inset

 , the first two indices are 
\begin_inset Formula $i,j_{1}=1$
\end_inset

, and are not used.
\end_layout

\begin_layout Itemize
Transient arrays in calculations use a reduced space-time index 
\begin_inset Formula $\bm{j}'=[1,j_{2},\ldots]$
\end_inset

 , with time index equal to one.
 
\end_layout

\begin_layout Itemize
Arrays in calculations are packed to have indices 
\begin_inset Formula $a(i,J)$
\end_inset

, where 
\begin_inset Formula $J=(\bm{j}',e)$
\end_inset

 is a flattened index.
\end_layout

\begin_layout Standard
The dimensionality of the fields being integrated is logically stored in
 the array shape 
\begin_inset Formula $r.d.fields=(i,\mathbf{j}',e)$
\end_inset

, which is packed for calculations into a matrix labelled 
\series bold
a
\series default
.
 The use of a two-dimensional index in internal storage simplifies many
 functions, and this two-dimensional shape is stored in the internal matrix
 shape 
\begin_inset Formula $r.d.a=(i,J)$
\end_inset

.
 Where Fourier transforms are used internally for linear propagation, the
 momentum arrays start at 
\begin_inset Formula $k=0$
\end_inset

 in the first index.
\end_layout

\begin_layout Standard
A 
\series bold
packed
\series default
 matrix, 
\begin_inset Formula $a$
\end_inset

, can always be unpacked into its full index array form using:
\begin_inset Formula 
\[
fields=reshape(a,r.d.fields)
\]

\end_inset


\end_layout

\begin_layout Standard
An 
\series bold
unpacked
\series default
 array, 
\begin_inset Formula $fields$
\end_inset

, can always be packed into its compressed array form using:
\begin_inset Formula 
\[
a=reshape(fields,r.d.a)
\]

\end_inset


\end_layout

\begin_layout Paragraph*

\series bold
Averaged data
\end_layout

\begin_layout Standard
The array index ordering for averages generated by the 
\emph on
observe
\emph default
 functions is still logically 
\begin_inset Formula $(i,\mathbf{j},e)$
\end_inset

, although there are differences, as follows: 
\end_layout

\begin_layout Itemize
Averaged data for storing or graphing is stored in unpacked form, including
 time for stored data, so that all indices can be readily accessed for graphing.
 
\end_layout

\begin_layout Itemize
Data obtained from functions of fields retains the first index to indicate
 different output lines on a graph.
 This also allows a vector average to be calculated.
 
\end_layout

\begin_layout Itemize
Averages that are defined in momentum space have the momentum origin at
 
\begin_inset Formula $k=0$
\end_inset

 is shifted to become the central index for graphing.
 
\end_layout

\begin_layout Itemize
Data that is ensemble averaged has no ensemble index, so the last index
 is used for storing error-bars instead.
\end_layout

\begin_layout Itemize
Where integrals or spatial averages are used, the entire array is filled
 to keep them homogeneous, although this will be changed in future.
\end_layout

\begin_layout Itemize
Where data is binned to get distributions, an extra 'space' dimension is
 added to 
\begin_inset Formula $\bm{j}$
\end_inset

 to store the binning index in each space-time location.
\end_layout

\begin_layout Section
Boundary conditions
\end_layout

\begin_layout Standard
Boundary conditions must be given for all partial differential equations.
 The default boundary conditions are periodic.
 The implicit setting of this is that periodicity is enforced such that
 
\begin_inset Formula $a\left(o_{i}-dx_{i}/2\right)=a\left(o_{i}+r_{i}+dx_{i}/2\right)$
\end_inset

 , which is the usual discrete Fourier transform requirement.
 
\end_layout

\begin_layout Standard
Otherwise, the differential equation boundaries are specified at 
\begin_inset Formula $a\left(o_{i}\right)$
\end_inset

, 
\begin_inset Formula $a\left(o_{i}+r_{i}\right)$
\end_inset

, using the cell-array input 
\begin_inset Formula $boundaries\{d\}(i,j)$
\end_inset

, which is defined per space dimension (
\begin_inset Formula $d=2,3..$
\end_inset

), field index (
\begin_inset Formula $i=1,2..$
\end_inset

) and boundary 
\begin_inset Formula $j=(1,2)$
\end_inset

.
 Here 
\begin_inset Formula $d>1$
\end_inset

 is the transverse dimension, not including time, which only has an initial
 condition.
 The available boundary types are: 
\end_layout

\begin_layout Description
Neumann: For specified 
\emph on
derivative
\emph default
 boundaries, 
\begin_inset Formula $boundaries\{d\}(i,j)=-1$
\end_inset


\end_layout

\begin_layout Description
Periodic: For 
\emph on
periodic
\emph default
 boundaries, 
\begin_inset Formula $boundaries\{d\}(i,j)=0$
\end_inset


\end_layout

\begin_layout Description
Dirichlet: For specified 
\emph on
field
\emph default
 boundaries, 
\begin_inset Formula $boundaries\{d\}(i,j)=1$
\end_inset


\end_layout

\begin_layout Standard
These are specified in a cell array: 
\begin_inset Formula $boundaries\{d\}(i,1)$
\end_inset

 sets the lower boundary type, while 
\begin_inset Formula $boundaries\{d\}(i,2)$
\end_inset

 gives the upper boundary type.
 Each space dimension, variable and boundary is set independently.
 Note that in xspde, the equations are always initial value problems in
 time, so the time dimension boundary specification for 
\begin_inset Formula $d=1$
\end_inset

 is not included.
 The default option is periodic boundaries if 
\begin_inset Formula $boundaries$
\end_inset

 is not specified.
 The boundary values returned by the default boundary function, 
\begin_inset Formula $xboundfun$
\end_inset

, are all zero.
\end_layout

\begin_layout Subsection
Setting the boundary values
\end_layout

\begin_layout Standard
For non-vanishing, specified boundary conditions, the boundary function
 
\begin_inset Formula $boundfun(a,d,r)$
\end_inset

 is called.
 This returns the boundary values used for the fields or derivatives in
 dimension 
\begin_inset Formula $d>1$
\end_inset

 as an array of dimension 
\begin_inset Formula $b(i,J,j,K))$
\end_inset

.
\end_layout

\begin_layout Standard
Here 
\begin_inset Formula $i$
\end_inset

 is the field index, 
\begin_inset Formula $J$
\end_inset

 is a flattened dimension equal to the product of field array dimensions
 for 
\begin_inset Formula $d_{1}<d$
\end_inset

, and 
\begin_inset Formula $K$
\end_inset

 is a flattened dimension equal to the product of field array dimensions
 for 
\begin_inset Formula $d_{2}>d$
\end_inset

, including the ensemble dimension.
 Crucially, 
\begin_inset Formula $j$
\end_inset

 is the index of the dimension whose boundary values are specified, so only
 two values are needed: 
\begin_inset Formula $j=1,2$
\end_inset

 for the upper and lower boundary values, which could either be field values
 or their derivatives.
\end_layout

\begin_layout Standard
Boundary values can be a function of both the fields (
\begin_inset Formula $a$
\end_inset

) and internal variables like the current time (
\begin_inset Formula $r.t$
\end_inset

).
 These may have predefined or stochastic initial values at 
\begin_inset Formula $t=0$
\end_inset

 which are calculated only once.
 In such cases the boundary values must first be initialized, so the routine
 
\begin_inset Formula $boundfun(a,d,r)$
\end_inset

 is internally initialized with time 
\begin_inset Formula $t<origin(1)$
\end_inset

, and with random Gaussian values in the input field 
\begin_inset Formula $a$
\end_inset

.
 These are delta-correlated in space, i.e., with the same definition as the
 
\begin_inset Quotes eld
\end_inset

randoms
\begin_inset Quotes erd
\end_inset

.
 The xSDPE program stores the returned values 
\begin_inset Formula $b$
\end_inset

 for the boundaries in an internal cell array, 
\begin_inset Formula $boundval\{d\}$
\end_inset

, for later use if required.
\end_layout

\begin_layout Standard
The default initial boundary value is zero, set by the default boundary
 function 
\begin_inset Formula $xboundfun(a,d,r)$
\end_inset

.
 Subsequent boundary values returned by 
\begin_inset Formula $xboundfun(a,d,r)$
\end_inset

, are set equal to the initial boundary values stored in 
\begin_inset Formula $boundval\{d\}$
\end_inset

.
 
\end_layout

\begin_layout Section
Fourier transforms
\end_layout

\begin_layout Standard
It is often useful to Fourier transform a field before it is averaged.
 This is controlled independently for each 
\begin_inset Formula $observe$
\end_inset

 function and space-time dimension by 
\begin_inset Formula $transforms$
\end_inset

.
 The xSPDE Fourier transforms or spectrum definitions in space-time are
 given by the symmetric Fourier transform definition:
\begin_inset Formula 
\begin{align}
\tilde{a}(\omega,\bm{k}) & =\mathcal{F}\left(a(t,\bm{x})\right)\nonumber \\
 & =\frac{1}{\left[2\pi\right]^{d/2}}\int e^{i(\omega t-\bm{k}\cdot\bm{x})}a(t,\bm{x})dtd\bm{x}\,
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The inverse Fourier transform is the function:
\begin_inset Formula 
\begin{align*}
a(t,\bm{x}) & =\mathcal{F}^{-1}\left(\tilde{a}\right)\\
 & =\frac{1}{\left[2\pi\right]^{d/2}}\int e^{i(\bm{k}\cdot\bm{x}-\omega t)}\tilde{a}(\omega,\bm{k})d\omega d\bm{k}\,
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
This is translated into a sum over the lattice points using a discrete Fourier
 transform at the lattice points 
\begin_inset Formula $x_{i}$
\end_inset

, so that: 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\tilde{a}(\omega_{i},\bm{k}_{i})=\frac{dtd\mathbf{x}}{\left[2\pi\right]^{d/2}}\sum_{j_{1}\ldots j_{d}}\exp\left[i\left(\omega_{i_{1}}t_{j_{1}}-\bm{k}_{\bm{i}}\cdot\bm{x}_{\bm{j}}\right)\right]a(t_{j_{1}},\bm{x}_{\bm{j}})\,
\end{equation}

\end_inset

The momenta 
\begin_inset Formula $k_{i}$
\end_inset

 have an interval of
\begin_inset Formula 
\begin{equation}
dk_{i}=\frac{2\pi}{n_{i}dx_{i}}
\end{equation}

\end_inset

with 
\begin_inset Formula $k_{i}$
\end_inset

 values given for even n by: 
\begin_inset Formula 
\begin{equation}
k_{i}=\left(1-\frac{n_{i}}{2}\right)dk_{i},\ldots\frac{n_{i}}{2}dk_{i}
\end{equation}

\end_inset

and for odd n by:
\begin_inset Formula 
\begin{equation}
k_{i}=\frac{1-n_{i}}{2}dk_{i},\ldots\frac{n_{i}-1}{2}dk_{i}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Once Fourier transformed, the 
\begin_inset Formula $observe$
\end_inset

 function can be used to take any further functions or combinations of Fourier
 transformed fields prior to averaging.
 Important points to keep in mind are as follows:
\end_layout

\begin_layout Itemize
Fourier transforms are specified for the k-th 
\emph on
observe 
\emph default
function independently of all other functions, by specifying 
\begin_inset Formula $transforms\{k\}=\left[\ell_{\ensuremath{1},}\ldots\ell_{\ensuremath{d},}\right]$
\end_inset

, 
\end_layout

\begin_layout Itemize
Here 
\begin_inset Formula $\ell_{j}=0,1$
\end_inset

 is a logical switch, set to to 
\begin_inset Formula $\ell_{j}=1$
\end_inset

 if the 
\begin_inset Formula $j-th$
\end_inset

 dimension requires a Fourier transform, and 
\begin_inset Formula $\ell_{j}=0$
\end_inset

 if there is no Fourier transform.
\end_layout

\begin_layout Itemize
The internal fields 
\begin_inset Formula $r.k\{1\},\ldots r.k\{d\}$
\end_inset

 are available for use in making functions of momentum for use with observations.
\end_layout

\begin_layout Itemize
In propagation calculations, the momentum lattice values start with 
\begin_inset Formula $k=0,\ldots$
\end_inset

, following standard Matlab and FFT conventions.
\end_layout

\begin_layout Itemize
For storing and graphing, momentum lattice values are reordered to start
 with 
\begin_inset Formula $k=-k_{max},\ldots$
\end_inset

, following standard graphics and mathematical conventions.
\end_layout

\begin_layout Standard
A stochastic partial differential equation or 
\begin_inset Formula $SPDE$
\end_inset

 for a complex vector field is defined in both time 
\begin_inset Formula $t$
\end_inset

 and space dimensions
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $\bm{x}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
.
 The total 
\emph on
dimension
\emph default
 
\begin_inset Formula $d$
\end_inset

 in xSPDE is unlimited, and includes time and space.
 Large 
\begin_inset Formula $d$
\end_inset

 is memory-intensive and slow! The general equation solved can be written
 in differential form as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\mathbf{a}}{\partial t}=\mathbf{A}\left[\mathbf{a}\right]+\underline{\mathbf{B}}\left[\mathbf{a}\right]\cdot\bm{w}(t)+\underline{\mathbf{L}}\left[\bm{\nabla},\mathbf{a}\right]\,.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The linear function 
\begin_inset Formula $L$
\end_inset

 is input as a separate function in xSPDE, to allow for greatest efficiency
 and use of an interaction picture.
 Note that it depends on momentum space coordinates, and this involves Fourier
 transforms.
\end_layout

\begin_layout Subsection
Specifying the equations
\end_layout

\begin_layout Standard
Details of how to input the equations are as follows:
\end_layout

\begin_layout Itemize
The initial conditions are specified by the user from the 
\emph on
initial(v,r)
\emph default
 function, where 
\begin_inset Formula $\mathbf{v}=\left[\bm{v}^{x},\bm{v}^{k}\right]$
\end_inset

 is an array of random initial values, delta-correlated in space or momentum
 space.
 For space correlations, set 
\begin_inset Formula $randoms(1)$
\end_inset

, for momentum correlations set 
\begin_inset Formula $randoms(2)$
\end_inset

.
 Here 
\begin_inset Formula $f^{(r)}(\bm{v}\left(\mathbf{k}\right))$
\end_inset

 is an arbitrary momentum filter, for correlated noise.
 Set this using the 
\emph on
rfilter(v,r) 
\emph default
function, specified by the user.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{A}\left[\mathbf{a}\right]$
\end_inset

 and 
\begin_inset Formula $\underline{\mathbf{B}}\left[\mathbf{a}\right]$
\end_inset

 are vector and matrix functions of 
\begin_inset Formula $\mathbf{a}$
\end_inset

, set by the user using the 
\emph on
da(a,w,r) 
\emph default
function.
 
\end_layout

\begin_layout Itemize
Here, 
\begin_inset Formula $\mathbf{w}=\left[\bm{w}^{x},\bm{w}^{k}\right]$
\end_inset

 are real noise fields, delta-correlated in time, and also in space or momentum,
 as explained below.
 
\end_layout

\begin_layout Itemize
The
\emph on
 linear
\emph default
 function 
\begin_inset Formula $L$
\end_inset

 is input as a function in xSPDE, to allow for greatest efficiency and use
 of an interaction picture.
 Here 
\begin_inset Formula $\underline{\mathbf{L}}\left[\bm{\nabla},\mathbf{a}\right]$
\end_inset

 is a matrix of 
\emph on
linear
\emph default
 terms including derivatives, diagonal in the array indices.
 Note that it depends on momentum space coordinates, and generally involves
 Fourier transforms.
 If 
\begin_inset Formula $d=1$
\end_inset

, there are no space dimensions or derivatives.
 The term 
\begin_inset Formula $\underline{\mathbf{L}}$
\end_inset

 may be omitted if not required.
\end_layout

\begin_layout Subsection
Initial random fields and noise transforms
\end_layout

\begin_layout Standard
Fourier transforms are available for use both on initial random values and
 on noise fields during time-evolution.
 This is controlled by the second element of 
\begin_inset Formula $randoms$
\end_inset

 and 
\begin_inset Formula $noises$
\end_inset

 respectively.
 
\end_layout

\begin_layout Standard
When 
\begin_inset Formula $randoms(1)>0$
\end_inset

, an initial random field 
\begin_inset Formula $\bm{v}^{x}$
\end_inset

 is generated with delta-correlations in 
\begin_inset Formula $x$
\end_inset

-space.
 When 
\begin_inset Formula $randoms(2)>0$
\end_inset

, an initial random field 
\begin_inset Formula $\tilde{\bm{v}}^{k}$
\end_inset

 is generated with delta-correlations in 
\begin_inset Formula $k$
\end_inset

-space.
 This is filtered with a user-specified filter function to give 
\begin_inset Formula $\tilde{\bm{v}}^{kf}$
\end_inset

, then inverse Fourier transformed to give 
\begin_inset Formula $v^{k}$
\end_inset

.
 Both random fields are passed to the 
\begin_inset Formula $initial$
\end_inset

 function as an extended vector 
\begin_inset Formula $\left[v^{x},v^{k}\right]$
\end_inset

, for field 
\emph on
initialization
\emph default
 in space.
\end_layout

\begin_layout Standard
There is a user specified filter function available, to modify random fields
 
\begin_inset Formula $\tilde{v}^{k}$
\end_inset

, that are delta-correlated in momentum space using a filter function, '
\emph on
rfilter
\emph default
' so that 
\begin_inset Formula $v_{i}^{kf}\left(\bm{k}\right)=f_{i}^{(r)}\left(\bm{v}^{k}\left(\bm{k}\right)\right)$
\end_inset

, before being used.
 The corresponding correlations are:
\begin_inset Formula 
\begin{eqnarray}
\left\langle v_{i}^{x}\left(\bm{x}\right)v_{j}^{x}\left(\bm{x}'\right)\right\rangle  & = & \delta\left(\bm{x}-\bm{x}'\right)\delta_{ij}\sim\frac{1}{\Delta V}\delta_{\bm{x},\bm{x}'}\delta_{ij}\nonumber \\
\left\langle \tilde{v}_{i}^{k}\left(\bm{k}\right)\tilde{v}_{j}^{k}\left(\bm{k}'\right)\right\rangle  & = & \delta\left(\bm{k}-\bm{k}'\right)\delta_{ij}\sim\frac{1}{\Delta K}\delta_{\bm{k},\bm{k}'}\delta_{ij}\nonumber \\
\left\langle \tilde{v}_{i}^{kf}\left(\bm{k}\right)\tilde{v}_{j}^{kf}\left(\bm{k}'\right)\right\rangle  & = & \left\langle f_{i}^{(r)}\left(\tilde{\bm{v}}^{k}\left(\bm{k}\right)\right)f_{j}^{(r)}\left(\tilde{\bm{v}}^{k}\left(\bm{k}'\right)\right)\right\rangle .
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Note that on a lattice, we replace the Dirac continuous delta-function by
 a discrete Kronecker delta function scaled by an inverse volume element
 either in space (
\begin_inset Formula $\Delta V$
\end_inset

) or momentum (
\begin_inset Formula $\Delta K$
\end_inset

) .
 The xSPDE Fourier transforms are given by a symmetric Fourier transform
 definition, so that if we inverse Fourier-transform the 
\begin_inset Formula $k-$
\end_inset

randoms, without filtering, then:
\begin_inset Formula 
\begin{equation}
v^{k}(\bm{x})=\frac{1}{\left[2\pi\right]^{(d-1)/2}}\int e^{i\bm{k}\cdot\bm{x}}\tilde{v}^{k}(\bm{k})d\bm{k}\,
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
These have random initial values that are real and delta-correlated in space,
 so that:
\begin_inset Formula 
\begin{equation}
\left\langle v^{x}\left(\bm{x}\right)v^{x}\left(\bm{x}'\right)\right\rangle =\delta\left(\bm{x}-\bm{x}'\right).
\end{equation}

\end_inset

The corresponding noises in position space are correlated according to:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\left\langle v^{k}\left(\bm{x}\right)\left(v^{k}\left(\bm{x}'\right)\right)^{*}\right\rangle  & =\frac{1}{\left[2\pi\right]^{(d-1)}}\int e^{i(\bm{k}\cdot\bm{x}-\bm{k}'\cdot\bm{x}')}\left\langle \tilde{v}^{k}\left(\bm{k}\right)\tilde{v}^{k}\left(\bm{k}'\right)\right\rangle d\bm{k}d\bm{k}'\nonumber \\
 & =\frac{1}{\left[2\pi\right]^{(d-1)}}\int e^{i(\bm{x}-\bm{x}')\cdot\bm{k}}d\bm{k}\nonumber \\
 & =\delta\left(\bm{x}-\bm{x}'\right).
\end{align}

\end_inset

 Similarly, if we don't conjugate the k-noise, then:
\begin_inset Formula 
\begin{equation}
\left\langle v^{k}\left(\bm{x}\right)v^{k}\left(\bm{x}'\right)\right\rangle =\delta\left(\bm{x}+\bm{x}'\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align*}
\left\langle v^{c}\left(\bm{x}\right)v^{c}\left(\bm{x}'\right)^{*}\right\rangle  & =\frac{1}{2\left[2\pi\right]^{(d-1)}}\int e^{-i(\bm{k}\cdot\bm{x}-\bm{k}'\cdot\bm{x}')}\left\langle \left(v_{1}^{x}\left(\bm{k}\right)+iv_{2}^{x}\left(\bm{k}\right)\right)\left(v_{1}^{x}\left(\bm{k}'\right)-iv_{2}^{x}\left(\bm{k}'\right)\right)\right\rangle d\bm{k}d\bm{k}'\\
 & =\frac{1}{\left[2\pi\right]^{(d-1)}}\int e^{-i(\bm{x}-\bm{x}')\cdot\bm{k}}d\bm{k}\\
 & =\delta\left(\bm{x}-\bm{x}'\right)
\end{align*}

\end_inset


\end_layout

\end_inset

However, if we define 
\begin_inset Formula $\tilde{v}^{c}\left(\bm{k}\right)=\left[\tilde{v}_{1}^{k}\left(\bm{k}\right)+i\tilde{v}_{2}^{k}\left(\bm{k}\right)\right]/\sqrt{2}$
\end_inset

 , then we obtain complex noise is only delta correlated when conjugated.
 
\begin_inset Formula 
\begin{align}
\left\langle v^{c}\left(\bm{x}\right)\left(v^{c}\left(\bm{x}'\right)\right)^{*}\right\rangle  & =\delta\left(\bm{x}-\bm{x}'\right)\nonumber \\
\left\langle v^{c}\left(\bm{x}\right)v^{c}\left(\bm{x}'\right)\right\rangle  & =0.
\end{align}

\end_inset

This is obtainable with the x-space noise as well, but the utility of the
 k-space noise is that it can be filtered to have nonlocal correlations
 in space if required.
 
\end_layout

\begin_layout Standard
During propagation in time, 
\begin_inset Formula $\mathbf{w}=\left[\bm{w}^{x},\bm{w}^{k}\right]$
\end_inset

 are real noise fields that are delta-correlated in space-time.
 They are calculated in an anlogous way, except with an additional factor
 of 
\begin_inset Formula $1/\sqrt{dt}$
\end_inset

 because they are delta correlated in time as well.There is a user specified
 scaling function available, to take random noises 
\begin_inset Formula $w^{k}$
\end_inset

 in momentum space that are then scaled using a filter function, '
\emph on
nfilter
\emph default
' so that 
\begin_inset Formula $w_{i}^{kf}\left(\bm{k}\right)=f_{i}^{(n)}\left(\bm{w}^{k}\left(\bm{k}\right)\right)$
\end_inset

, before being used:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\left\langle w_{i}^{x}\left(t,\bm{x}\right)w_{j}^{x}\left(t,\bm{x}'\right)\right\rangle  & = & \delta\left(\bm{x}-\bm{x}'\right)\delta\left(t-t'\right)\delta_{ij}\nonumber \\
\left\langle \tilde{w}_{i}^{k}\left(t,\bm{k}\right)\tilde{w}_{j}^{k}\left(t,\bm{k}'\right)\right\rangle  & = & \delta\left(\bm{k}-\bm{k}'\right)\delta\left(t-t'\right)\delta_{ij}\nonumber \\
\left\langle \tilde{w}_{i}^{kf}\left(t,\bm{k}\right)\tilde{w}_{j}^{kf}\left(t',\bm{k}'\right)\right\rangle  & = & \left\langle f_{i}^{(n)}\left(\tilde{\bm{w}}^{k}\left(t,\bm{k}\right)\right)f_{j}^{(n)}\left(\tilde{\bm{w}}^{k}\left(t',\bm{k}'\right)\right)\right\rangle .
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Section
Stochastic Ginzburg-Landau
\end_layout

\begin_layout Standard
Including two space dimensions, or space-time dimensions of 
\begin_inset Formula $d=3$
\end_inset

, an example of a SPDE is the stochastic Ginzburg-Landau equation.
 This describes symmetry breaking.
 The system develops a spontaneous phase which varies spatially as well.
 The model is used to describe lasers, magnetism, superconductivity, superfluidi
ty and particle physics: 
\begin_inset Formula 
\begin{equation}
\dot{a}=\left(1-\left|a\right|^{2}\right)a+bw(t)+c\nabla^{2}a
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\left\langle w(x)w^{*}(x')\right\rangle =2\delta\left(t-t'\right)\delta\left(x-x'\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The following new ideas are introduced for this problem: 
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{dimension}$
\end_inset

 is the space-time dimension.

\series default
 
\end_layout

\begin_layout Enumerate

\series bold
The
\series default
 'dot' 
\series bold
notation used for parallel operations over lattices
\series default
.
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{linear}$
\end_inset

 is the linear operator - a laplacian in these cases.
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{images}$
\end_inset

 produces movie-style images at discrete time slices.
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $\mathtt{Dx}$
\end_inset

 indicates a derivative operation, 
\begin_inset Formula $\partial/\partial x$
\end_inset

.

\series default
 
\end_layout

\begin_layout Enumerate

\series bold
\begin_inset Formula $-5<x<5$
\end_inset

 is the default xSPDE coordinate range in space.

\series default
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the stochastic G-L equation for 
\begin_inset Formula $b=0.001$
\end_inset

 and 
\begin_inset Formula $c=0.01i$
\end_inset

.
\end_layout

\begin_layout Itemize

\series bold
Change to a real diffusion so that 
\begin_inset Formula $c=0.1$
\end_inset

.
\end_layout

\begin_layout Standard
In the first case, you should get the output graphed in Fig (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Symmetry-breaking"

\end_inset

) .
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
clear;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
name = 'Extended laser gain equation';
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
noises=2;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
dimension=3;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
steps=10;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
linear = @(r) i*0.01*(r.Dx.^2+r.Dy.^2);
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
observe = @(a,~) abs(a).^2;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
images =6;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels = '|a|^2';
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
da=@(a,w,~) (1-abs(a(1,:)).^2).*a+0.001*(w(1,:)+i*w(2,:));
\end_layout

\begin_layout Plain Layout

\family typewriter
xspde(
\family default
r)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here the notation 
\begin_inset Formula $z(1,:)$
\end_inset

 is like the dot: the colon means that the operation is repeated over all
 values of the second index, which is the spatial lattice index.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset


\begin_inset Graphics
	filename ../../xspde_matlab3.1/users guide/Figures/GinzLand.pdf
	width 75text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Symmetry-breaking"

\end_inset

Simulation of the stochastic equation describing symmetry breaking in two
 dimensions.
 Spatial fluctuations are caused by the different phase-domains that interfere.
 The graph obtained here is projected onto the 
\begin_inset Formula $y=0$
\end_inset

 plane.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Soliton
\end_layout

\begin_layout Standard
The famous nonlinear Schrödinger equation (NLSE) is: 
\begin_inset Formula 
\[
\frac{da}{dt}=\frac{i}{2}\left[\nabla^{2}a-a\right]+ia\left|a\right|^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
Together with the initial condition that 
\begin_inset Formula $a(0,x)=sech(x)$
\end_inset

, this has a soliton, an exact solution that doesn't change in time: 
\begin_inset Formula 
\begin{eqnarray*}
a(t,x) & = & sech(x)
\end{eqnarray*}

\end_inset

The Fourier transform at 
\begin_inset Formula $k=0$
\end_inset

 is simply: 
\begin_inset Formula 
\begin{eqnarray*}
\tilde{a}(t,0) & = & \frac{1}{\sqrt{2\pi}}\int sech(x)dx=\sqrt{\frac{\pi}{2}}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the NLSE for a soliton
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
f
\family typewriter
unction [e] = Soliton() 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
name = 'NLS soliton';
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
dimension = 2; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
initial = @(v,r) sech(r.x); 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
da = @(a,~,r) i*a.*(conj(a).*a);
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
linear = @(r) 0.5*i*(r.Dx.^2-1.0);
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels = {'a_1(x)'}; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
compare{1}= @(t,~) 1; 
\end_layout

\begin_layout Plain Layout

\family typewriter
e = xspde(
\family default
r)
\family typewriter
; 
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize

\series bold
Add an additive complex noise of 
\begin_inset Formula $0.01(w_{1}+iw_{2}$
\end_inset

) to the differential equation, then replot with an average over 
\begin_inset Formula $1000$
\end_inset

 samples.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Gaussian diffraction 
\end_layout

\begin_layout Standard
Free diffraction of a Gaussian wave-function in three dimensions, is given
 by 
\begin_inset Formula 
\[
\frac{da}{dt}=\frac{i}{2}\nabla^{2}a
\]

\end_inset


\end_layout

\begin_layout Standard
The xSPDE spectral definition in space-time is:
\begin_inset Formula 
\[
\tilde{a}(\omega,\bm{k})=\frac{1}{\left[2\pi\right]^{d/2}}\int e^{i(\bm{k}\cdot\bm{x}-\omega t)}a(t,\bm{x})dtd\bm{x}\,
\]

\end_inset


\end_layout

\begin_layout Standard
Together with the initial condition that 
\begin_inset Formula $a(0,x)=exp(-\left|\mathbf{x}\right|^{2}/2)$
\end_inset

, this has an exact solution for the diffracted intensity in either ordinary
 space or momentum space is therefore: 
\begin_inset Formula 
\begin{eqnarray*}
\left|a\left(t,\mathbf{x}\right)\right|^{2} & = & \frac{1}{\left(1+t^{2}\right)^{3/2}}exp(-\left|\mathbf{x}\right|^{2}/\left(1+t^{2}\right))\\
\left|\tilde{a}\left(t,\mathbf{k}\right)\right|^{2} & = & exp(-\left|\mathbf{k}\right|^{2})
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
To get an output from a spatially Fourier transformed field in three-dimensions,
 but without a Fourier transform in time, just set 
\begin_inset Formula $transforms=[0,1,1,1]$
\end_inset

, for the particular observable you need to calculate in transform space.
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the diffraction equation without noise
\end_layout

\begin_layout Itemize
Note that the example below stores data in a standardized HDF5 file.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [e] = Gaussian() 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
dimension = 4; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
initial = @(v,r) exp(-0.5*(r.x.^2+r.y.^2+r.z.^2));
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
linear = @(r) 1i*0.05*(r.Dx.^2+r.Dy.^2+r.Dz.^2); 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
observe = @(a,r) a.*conj(a); 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels = '|a(x)|^2'; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
file = 'Gaussian.h5';
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
images = 4;
\end_layout

\begin_layout Plain Layout

\family typewriter
[e,r] = xsim(
\family default
r)
\family typewriter
; 
\end_layout

\begin_layout Plain Layout

\family typewriter
e = xgraph(
\family default
r.
\family typewriter
file); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\family default
 
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Add an additive complex noise of 
\begin_inset Formula $0.01(w_{1}+iw_{2}$
\end_inset

) to the Gaussian differential equation, then replot with an average over
 
\begin_inset Formula $10$
\end_inset

 samples.
\end_layout

\begin_layout Standard
Note that for this, you'll need to define 
\begin_inset Formula $r.da=@(a,w,r)0.01*(w(1,:)+i*w(2,:))$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Planar noise
\end_layout

\begin_layout Standard
The next example is growth of thermal noise of a two-component complex field
 in a plane, given by the equation 
\begin_inset Formula 
\[
\frac{d\bm{a}}{dt}=\frac{i}{2}\nabla^{2}\bm{a}+\bm{w}(t,x)
\]

\end_inset

where 
\begin_inset Formula $\bm{\zeta}$
\end_inset

 is a delta-correlated complex noise vector field: 
\begin_inset Formula 
\[
w_{j}(t,\mathbf{x})=\left[w_{j}^{re}(t,\mathbf{x})+i\zeta_{j}^{im}(t,\mathbf{x})\right]/\sqrt{2},
\]

\end_inset

with the initial condition that the initial noise is delta-correlated in
 position space 
\begin_inset Formula 
\[
a(0,\mathbf{x})=\bm{\zeta}^{(in)}(\bm{x})
\]

\end_inset

where: 
\begin_inset Formula 
\[
\bm{\zeta}^{(in)}(\bm{x})=\left[\bm{\zeta}^{re(in)}(\mathbf{x})+i\bm{\zeta}^{im(in)}(\mathbf{x})\right]/\sqrt{2}
\]

\end_inset


\end_layout

\begin_layout Standard
This has an exact solution for the noise intensity in either ordinary space
 or momentum space: 
\begin_inset Formula 
\begin{eqnarray*}
\left\langle \left|a_{j}\left(t,\mathbf{x}\right)\right|^{2}\right\rangle  & = & (1+t)/dV\\
\left\langle \left|\tilde{a}_{j}\left(t,\mathbf{k}\right)\right|^{2}\right\rangle  & = & (1+t)/dV_{k}\\
\left\langle \tilde{a}_{1}\left(t,\mathbf{k}\right)\tilde{a}_{2}^{*}\left(t,\mathbf{k}\right)\right\rangle  & = & 0
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Here, the noise is delta-correlated, and 
\begin_inset Formula $dV$
\end_inset

, 
\begin_inset Formula $dV_{k}$
\end_inset

 are the cartesian space and momentum space lattice cell volumes respectively.
 Suppose that 
\begin_inset Formula $n=n_{x}n_{y}$
\end_inset

 is the total number of spatial points, and there are 
\begin_inset Formula $n_{x(y)}$
\end_inset

 points in the x(y)-direction, so then: 
\begin_inset Formula 
\begin{eqnarray*}
dV & = & dxdy\\
dV_{k} & = & dk_{x}dk_{y}=\frac{(2\pi)^{2}}{ndV}.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
In the simulations, two planar noise fields are propagated, one using delta-corr
elated noise, the other with noise transformed to momentum space to allow
 filtering.
 This allows use of finite correlation lengths when needed, by including
 a frequency filter function that is used to multiply the noise in Fourier-space.
 The Fourier-space noise variance is the square of the filter function.
 
\end_layout

\begin_layout Standard
The first noise index, 
\begin_inset Formula $r.noises(1)$
\end_inset

, indicates how many noise fields are generated, while 
\begin_inset Formula $r.noises(2)$
\end_inset

 indicates how many of these are spatially correlated, via Fourier transform,
 filter and inverse Fourier transform.
 These appear to the user as additional noises, so the total is 
\begin_inset Formula $r.noises(1)+r.noises(2)$
\end_inset

.
 The filtered noises have a finite correlation length.
 They are correlated with the first 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $r.noises(1)$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 x-space noises they are generated from, as this can be useful.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the planar noise growth equation
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [e] = Planar() 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
name = 'Planar noise growth'; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
dimension = 3; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
fields = 2; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
ranges = [1,5,5]; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
steps = 2; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
noises = [2,2]; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
ensembles = [10,4,4]; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
initial = @Initial; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
da = @Da; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
linear = @Linear; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
observe = @(a,r) a(1,:).*conj(a(1,:));
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels= '<|a_1(x)|^2>';
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
compare = @(t,
\family default
r)
\family typewriter
 [1+t]/
\family default
r.
\family typewriter
dv;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
images = 4; 
\end_layout

\begin_layout Plain Layout

\family typewriter
e = xspde(
\family default
r)
\family typewriter
; 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\family default

\begin_inset Newline newline
\end_inset

 
\family typewriter
 
\end_layout

\begin_layout Plain Layout

\family typewriter
function a0 = Initial(v,r) 
\end_layout

\begin_layout Plain Layout

\family typewriter
a0(1,:) = (v(1,:)+1i*v(2,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
a0(2,:) = (v(3,:)+1i*v(4,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\family default

\begin_inset Newline newline
\end_inset


\family typewriter
 
\end_layout

\begin_layout Plain Layout

\family typewriter
function da = Da(a,z,r) 
\end_layout

\begin_layout Plain Layout

\family typewriter
da(1,:) = (z(1,:)+1i*z(2,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
da(2,:) = (z(3,:)+1i*z(4,:))/sqrt(2); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\family default

\begin_inset Newline newline
\end_inset

 
\family typewriter
 
\end_layout

\begin_layout Plain Layout

\family typewriter
function L = Linear(r) 
\end_layout

\begin_layout Plain Layout

\family typewriter
lap = r.Dx.^2+r.Dy.^2; 
\end_layout

\begin_layout Plain Layout

\family typewriter
L(1,:) = 1i*0.5*lap(:); 
\end_layout

\begin_layout Plain Layout

\family typewriter
L(2,:) = 1i*0.5*lap(:); 
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize

\series bold
Add a decay rate of 
\begin_inset Formula $-a$
\end_inset

 to the differential equation, then replot
\end_layout

\begin_layout Itemize

\series bold
Add growth and nonlinear saturation terms
\end_layout

\begin_layout Section
GPE
\end_layout

\begin_layout Standard
The next example is a Gross-Pitaevskii equation in two dimensions, 
\begin_inset Formula 
\[
\frac{da}{dt}=\frac{i}{2}\nabla^{2}a-ia(V(r)+\left|a\right|^{2})+\epsilon\eta
\]

\end_inset

where 
\begin_inset Formula $\eta$
\end_inset

 is a correlated complex noise vector field: 
\begin_inset Formula 
\[
\eta(t,\mathbf{x})=w_{1}(t,\mathbf{x})+iw_{2}(t,\mathbf{x}),
\]

\end_inset

with the initial condition that the initial random field and the noise are
 both filtered in momentum space 
\begin_inset Formula 
\[
a(0,\mathbf{x})=a_{0}(\mathbf{x})+\epsilon\zeta^{(in)}(\bm{x})
\]

\end_inset

where: 
\begin_inset Formula 
\[
\zeta^{(in)}(\bm{x})=v_{1}(\mathbf{x})+iv_{2}(\mathbf{x})
\]

\end_inset


\end_layout

\begin_layout Standard
We add a Gaussian filter in momentum space for both the initial random field
 and noise so that, if 
\begin_inset Formula $\tilde{w}\left(\bm{k}\right)$
\end_inset

 is a delta-correlated noise in momentum space:
\begin_inset Formula 
\begin{align*}
w\left(\bm{k}\right) & =\tilde{w}\left(\bm{k}\right)\exp\left(-\left|\bm{k}\right|^{2}\right)\\
v\left(\bm{k}\right) & =\tilde{v}\left(\bm{k}\right)\exp\left(-\left|\bm{k}\right|^{2}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
This allows use of finite correlation lengths when needed, by including
 a frequency filter function that is used to multiply the noise in Fourier-space.
 The Fourier-space noise variance is the square of the filter function.
 
\end_layout

\begin_layout Standard
The first noise index, 
\begin_inset Formula $r.noises(1)$
\end_inset

, indicates how many noise fields are generated that are delta-correlated
 in 
\begin_inset Formula $x$
\end_inset

, while 
\begin_inset Formula $r.noises(2)$
\end_inset

 indicates how many of these are spatially correlated, via Fourier transform,
 filter and inverse Fourier transform.
 These appear to the user as additional noises, so the total is 
\begin_inset Formula $r.noises(1)+r.noises(2)$
\end_inset

.
 The filtered noises have a finite correlation length.
 
\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the GPE equation
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [e] = GPE() 
\end_layout

\begin_layout Plain Layout

\family typewriter
% e = GPE() tests xSPDE for a vortex in two space dimensions
\end_layout

\begin_layout Plain Layout

\family typewriter
% Tests a three-dimensional noisy GPE in a harmonic well by
\end_layout

\begin_layout Plain Layout

\family typewriter
% (1) Modifying points and ranges in 3 dimensions
\end_layout

\begin_layout Plain Layout

\family typewriter
% (2) Using momentum filters on noises generated
\end_layout

\begin_layout Plain Layout

\family typewriter
% (3) Setting the noise and random transform filter in k-space
\end_layout

\begin_layout Plain Layout

\family typewriter
% (4) Changing the movie image type to give a contour plot
\end_layout

\begin_layout Plain Layout

\family typewriter
% (5) Using auxiliary functions defined inline
\end_layout

\begin_layout Plain Layout

\family typewriter
% (6) Graphing data from results saved in an HDF5 file
\end_layout

\begin_layout Plain Layout

\family typewriter
% xSPDE functions are licensed by Peter D.
 Drummond, (2015) - see License
\end_layout

\begin_layout Plain Layout

\family typewriter
cd ~
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
name = 'GPE';
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
dimension = 3; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
points = [101,64,64];
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
ranges = [1,20,20];
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
noises = [0,2];
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
rfilter = @(w,r) w.*[exp(- r.kx.^2-r.ky.^2);exp(- r.kx.^2-r.ky.^2)];
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
nfilter = @(v,r) v.*[exp(- r.kx.^2-r.ky.^2);exp(- r.kx.^2-r.ky.^2)];
\end_layout

\begin_layout Plain Layout

\family typewriter
b = @(xi) .1*(xi(1,:)+1i*xi(2,:));
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
initial = @(w,r) (r.x+1i*r.y)./(1+10*(r.x.^2 +r.y.^2))+b(w);
\end_layout

\begin_layout Plain Layout

\family typewriter
V = @(r) 0.01*(r.x.^2 +r.y.^2)-0.001*1i*(r.x.^2 +r.y.^2).^2;
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
da = @(a,xi,r) -1i*a.*(V(r)+conj(a).*a)+b(xi);
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
linear = @(r) 0.5*1i*(r.Dx.^2+r.Dy.^2);
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
observe{1} = @(a,r) a.*conj(a);
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
images = {2}; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
imagetype = {2}; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels = {'|a|^2'};
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
file = 'GPE.mat';
\end_layout

\begin_layout Plain Layout

\family typewriter
%
\family default
r.
\family typewriter
print =2;
\end_layout

\begin_layout Plain Layout

\family typewriter
[e,r] = xsim(
\family default
r)
\family typewriter
; %%sim program
\end_layout

\begin_layout Plain Layout

\family typewriter
xgraph(
\family default
r.
\family typewriter
file,
\family default
r)
\family typewriter
; %%graph program
\end_layout

\begin_layout Plain Layout

\family typewriter
end %%end of function
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Characteristic equation
\end_layout

\begin_layout Standard
The next example is the characteristic equation for a traveling wave at
 constant velocity.
 It is included to illustrate what happens at periodic boundaries, when
 Fourier-transform methods are used for propagation.
 There are a number of methods known to prevent this effect, including addition
 of absorbers - often called apodization - at the boundaries.
 The equation is: 
\begin_inset Formula 
\[
\frac{da}{dt}+\frac{da}{dx}=0
\]

\end_inset


\end_layout

\begin_layout Standard
Together with the initial condition that 
\begin_inset Formula $a(0,x)=sech(2x+5)$
\end_inset

, this has an exact solution that propagates at a constant velocity: 
\begin_inset Formula 
\begin{eqnarray*}
a(t,x) & = & sech(2(x-t)+5)
\end{eqnarray*}

\end_inset

The time evolution at 
\begin_inset Formula $x=0$
\end_inset

 is simply: 
\begin_inset Formula 
\begin{eqnarray*}
a(t,0) & = & sech(2(t-5/2))
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection*
Exercises
\end_layout

\begin_layout Itemize

\series bold
Solve the characteristic equation given above, noting the effects of periodic
 boundaries.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function [e] = Characteristic() 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
name = 'Characteristic'
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
dimension = 2; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
initial = @(v,r) sech(2.*(r.x+2.5)); 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
da = @(a,z,r) 0*a; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
linear = @(r) -r.Dx; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
olabels = {'a_1(x)'}; 
\end_layout

\begin_layout Plain Layout
r.
\family typewriter
compare = @(t,
\family default
r)
\family typewriter
 sech(2.*(t-2.5)); 
\end_layout

\begin_layout Plain Layout

\family typewriter
e = xspde(
\family default
r)
\family typewriter
; 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\end_layout

\end_inset

 
\end_layout

\begin_layout Itemize

\series bold
Recalculate with the opposite velocity, and a new exact solution.
\end_layout

\begin_layout Section
Challenge problem #2
\end_layout

\begin_layout Standard
Counter-intuitively, a random potential 
\emph on
prevents
\emph default
 normal wave-packet spreading in quantum-mechanics.
 This is Anderson localization: a famous property of quantum mechanics in
 a random potential.
 A typical experimental method is to confine an ultra-cold Bose-Einstein
 condensate (BEC) in a trap, then release the BEC in a random external potential
 produced by a laser.
 The expansion rate of the BEC is reduced by the Anderson localization due
 to the random potential.
 Physically, the observable quantity is the particle density 
\begin_inset Formula $n=\left|\psi\right|^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
This can be treated either using a Schrodinger equation with a random potential,
 at low density, or using the Gross-Pitaevskii (GP) equation to include
 atom-atom interactions at the mean field level.
 In this example of a problem where strong localization occurs, the general
 equations are: 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial\psi}{\partial t}=\frac{1}{i\hbar}\left[-\frac{\hbar^{2}}{2m}\nabla^{2}+V\left(\bm{r}\right)+g\left|\psi\right|^{2}\right]\psi
\]

\end_inset


\end_layout

\begin_layout Standard
In calculations, it is best to use a dimensionless form by rescaling coordinates
 and fields.
 A simple way to simulate this with xSPDE is to treat 
\begin_inset Formula $\psi$
\end_inset

 as a scaled field 
\begin_inset Formula $a(1),$
\end_inset

 and to assume the random potential field 
\begin_inset Formula $V\left(\bm{r}\right)$
\end_inset

 as caused by interactions with second random field 
\begin_inset Formula $\left|a(2)\right|^{2}$
\end_inset

.
 This has the advantage that it is similar to the actual experiment, and
 allows one to treat time-dependent potentials as well, if desired.
 
\end_layout

\begin_layout Standard
With the rescaling, this simplifies to:
\begin_inset Formula 
\[
\frac{\partial a_{1}}{\partial\tau}=i\left[\frac{\partial}{\partial\zeta^{2}}^{2}-\left|a_{2}\right|^{2}-\left|a_{1}\right|^{2}\right]a_{1}
\]

\end_inset


\end_layout

\begin_layout Standard
A convenient initial condition is to use: 
\begin_inset Formula 
\begin{eqnarray*}
a_{1} & = & a_{0}\exp(-\zeta^{2})\\
\left\langle a_{2}(\zeta)a_{2}(\zeta')\right\rangle  & = & v\delta\left(\zeta-\zeta'\right)
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection*
Exercise
\end_layout

\begin_layout Itemize

\series bold
Solve Schrodinger's equation without a random potential, to observe expansion.
\end_layout

\begin_layout Itemize

\series bold
Include a random potential 
\begin_inset Formula $v$
\end_inset

, to observe localization.
\end_layout

\begin_layout Itemize

\series bold
Experiment with nonlinear terms and higher dimensions.
\end_layout

\begin_layout Standard
Note that the GP equation is a mean field approximation; this is still not
 a full solution of the many-body problem! Also, the experiments are somewhat
 more complicated than this, and actually observe the momentum distribution.
\end_layout

\begin_layout Chapter
Logic and data
\begin_inset CommandInset label
LatexCommand label
name "chap:Logic-and-data"

\end_inset


\end_layout

\begin_layout Standard
The simulation program logic is straightforward.
 It is a very compact function called 
\series bold
xspde
\series default
.
 This calls 
\series bold
xSIM
\series default
, for the simulation, then 
\series bold
xGRAPH
\series default
 for the graphics.
 Most of the work is done by other specialized functions.
 Input parameters come from an 
\series bold
input
\series default
 array, output is saved either in a 
\series bold
data
\series default
 array, or else in a specified file.
 During the simulation, global averages and error-bars are calculated for
 both time-step and sampling errors.
 When completed, timing and error results are printed.
 
\end_layout

\begin_layout Section
Simulations: 
\emph on
xSIM
\end_layout

\begin_layout Subsection
Input and data structures
\end_layout

\begin_layout Standard
To explain xSPDE in full detail, 
\end_layout

\begin_layout Itemize
Simulation inputs are stored in the 
\series bold
input
\series default
 cell array.
 
\end_layout

\begin_layout Itemize
This describes a 
\emph on
sequence
\emph default
 of simulations, so that 
\series bold
input={r1,r2,...}
\series default
.
 
\end_layout

\begin_layout Itemize
Each structure 
\series bold
r1,r2,...

\series default
 describes a simulation, whose output is the input of the next.
 
\end_layout

\begin_layout Itemize
The main simulation function is called using 
\begin_inset Formula $\mathbf{xsim(input)}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Averages are recorded sequentially in the 
\series bold
data
\series default
 cell array.
 
\end_layout

\begin_layout Itemize
Raw trajectory data is stored in the 
\series bold
raw
\series default
 cell array if required.
 
\end_layout

\begin_layout Standard
The sequence 
\begin_inset Formula $\mathbf{input}$
\end_inset

 has a number of individual simulation objects, with parameters that specify
 the simulation functions and give the equations and observables.
 If there is only one simulation, just one data structure is needed, without
 requiring a cell array.
 In addition, xSPDE generates graphs with its own graphics program.
 
\end_layout

\begin_layout Subsection
User definable simulation functions
\end_layout

\begin_layout Standard
The most commonly used functions are indicated with an asterisk.
 Others have automatic defaults that are not usually changed, except in
 special cases.
\end_layout

\begin_layout Description
*initial is used to initialize each integration in time.
 This is a user-defined function, which can involve random numbers if there
 is an initial probability distribution.
 This creates a stochastic field on the lattice, called 
\series bold
\emph on
a.

\series default
\emph default
 The default is 
\begin_inset Formula $\mathbf{xinitial}$
\end_inset

, which sets fields to zero.
 The returned first dimension should be fields(1).
 
\end_layout

\begin_layout Description
*observe is the initial observation function, whose output is averaged over
 the ensembles, called from 
\series bold
xpath
\series default
.
 The default, 
\begin_inset Formula $\mathbf{xobserve}$
\end_inset

, returns the real part of the amplitudes.
 
\end_layout

\begin_layout Description
*function is an optional function used to take arbitrary transforms of the
 initial observe outputs, after averaging over the 
\emph on
first
\emph default
 ensemble.
 The default returns the averages unchanged.
 
\end_layout

\begin_layout Description
*linear is the linear response, including transverse derivatives in space.
 The default, 
\begin_inset Formula $\mathbf{xlinear}$
\end_inset

, sets this to zero.
 
\end_layout

\begin_layout Description
*da is called by 
\series bold
step
\series default
 to calculate derivatives of the stochastic fields at every step in the
 process, including the stochastic terms.
 The default, 
\begin_inset Formula $\mathbf{xstep}$
\end_inset

, sets this to zero.
 The returned first dimension should be fields(1).
 All stochastic fields are accessible as 
\begin_inset Formula $a(n,:)$
\end_inset

, where 
\begin_inset Formula $n\leq fields(1)$
\end_inset

.
\end_layout

\begin_layout Description
*define is called by 
\series bold
step
\series default
 to calculate any user-defined auxiliary fields.
 The default, 
\begin_inset Formula $\mathbf{xdefine}$
\end_inset

, sets these to zero.
 The returned first dimension should be fields(2).
 If auxiliary fields are used they are accessible as 
\begin_inset Formula $a(n,:)$
\end_inset

, where 
\begin_inset Formula $n>fields(1)$
\end_inset

.
\end_layout

\begin_layout Description

\series bold
transfer
\series default
 is a function used to initialize sequential simulations,
\series bold
 
\series default
where previous or output stochastic field values are automatically included
 as input to the next stage ine the intergation sequence.
 The default, 
\begin_inset Formula $\mathbf{xtransfer}$
\end_inset

, uses the output of the previous simulation for the input to the next stage.
 This can be changed by the user.
\end_layout

\begin_layout Description
step is the algorithm that computes each step in time.
 This also generates the random numbers at each time-step.
 Options include 
\series bold
xEuler
\series default
, 
\series bold
xRK2
\series default
, 
\series bold
xRK4, 
\series default
for Euler and Runge-Kutta integration methods.
 This can be user-modified by initializing the handle 
\emph on
step
\emph default
 to add a new integration function.
 The default is 
\begin_inset Formula $\mathbf{xRK4}$
\end_inset

, which is widely applicable.
 Another good option is
\begin_inset Formula $\mathbf{xMP}$
\end_inset

, which uses a midpoint or central-difference technique in the interaction
 picture.
\end_layout

\begin_layout Description
rfilter returns a momentum filter for random initial fields generated in
 momentum space.
 The default, 
\begin_inset Formula $\mathbf{xrfilter}$
\end_inset

, sets this to unity.
\end_layout

\begin_layout Description
nfilter returns a momentum filter for random noises generated in momentum
 space.
 The default, 
\begin_inset Formula $\mathbf{xnfilter}$
\end_inset

, sets this to unity.
\end_layout

\begin_layout Description

\series bold
grid
\series default
 calculates the spatial integration grid.
 The default, 
\begin_inset Formula $\mathbf{xgrid}$
\end_inset

, returns a rectangular grid in ordinary and momentum space.
\end_layout

\begin_layout Description

\series bold
prop
\series default
 is the spatial propagation function.
 The default, 
\begin_inset Formula $\mathbf{xprop}$
\end_inset

, takes a Fourier transform of 
\begin_inset Formula $\bm{a}$
\end_inset

, multiplies by propfactor to propagate in time, then takes an inverse Fourier
 transform.
 
\end_layout

\begin_layout Description

\series bold
randomgen
\series default
 generates the initial random fields.
 The default, 
\begin_inset Formula $\mathbf{xrandomgen}$
\end_inset

, returns Gaussian real fields that are delta-correlated in space or momentum
 space.
\end_layout

\begin_layout Description

\series bold
noisegen
\series default
 generates the initial random fields.
 The default, 
\begin_inset Formula $\mathbf{xnoisegen}$
\end_inset

, returns Gaussian real noises that are delta-correlated in time and also
 in space or momentum space.
\end_layout

\begin_layout Description
propfactor returns the interaction picture propagation factors.
 The default, 
\begin_inset Formula $\mathbf{xpropfactor}$
\end_inset

, uses data from the 
\begin_inset Formula $\mathbf{linear}$
\end_inset

 function to calculate this.
\end_layout

\begin_layout Section
Arrays and errors
\end_layout

\begin_layout Standard
Knowing the details of array indexing inside xSPDE isn't usually necessary.
 Yet it becomes important if you want to write your own functions to extend
 xSPDE, interface xSPDE with other functions, or read and write xSPDE data
 files with external programs.
 It also helps to understand how the program works.
\end_layout

\begin_layout Subsection
Simulation data in xSIM
\end_layout

\begin_layout Standard
In xSIM, the space-time dimension 
\begin_inset Formula $d$
\end_inset

 is unlimited, although xGRAPH can only plot up to three selected choices
 of axes.
 All data, including grid coordinates, fields and average results is stored
 in real or complex numerical arrays of implicit or explicit rank 
\begin_inset Formula $2+d$
\end_inset

.
 During the stochastic simulation, these arrays are flattened to matrices,
 to shorten the Matlab code in the user functions.
 This preserves the same implicit index ordering, and these flattened matrices
 can be expanded into full arrays.
\end_layout

\begin_layout Standard
The array index ordering in all xSPDE functions always 
\begin_inset Formula $(i,\mathbf{j},e)$
\end_inset

, where: 
\end_layout

\begin_layout Itemize
The first index is a field index (
\begin_inset Formula $i$
\end_inset

).
 In cases like coordinates where this isn't needed, the first index is 
\begin_inset Formula $i=1$
\end_inset

.
 
\end_layout

\begin_layout Itemize
The next 
\begin_inset Formula $d$
\end_inset

 indices 
\begin_inset Formula $j_{1},\ldots j_{d}\equiv\bm{j}$
\end_inset

 are for time and space, where 
\begin_inset Formula $\bm{j}$
\end_inset

 indicates a 
\begin_inset Formula $d$
\end_inset

-dimensional index
\end_layout

\begin_layout Itemize
To conserve memory, transient arrays during calculations use 
\begin_inset Formula $\bm{j}'=[1,j_{2},\ldots]$
\end_inset

 , which indicates a 
\begin_inset Formula $d$
\end_inset

 dimensional index with time index set to one.
 
\end_layout

\begin_layout Itemize
The last index is an ensembles or checks index (
\begin_inset Formula $e$
\end_inset

).
 For fields, this is used to store field trajectories.
 
\end_layout

\begin_layout Standard
When the fields, noises or coordinates are integrated by the xSIM integration
 functions, the field and data arrays are always flattened to a matrix.
 This is for reasons of convenience in defining mathematical operations.
 The first index is the field or line index, and the combined second index
 covers all the rest: 
\begin_inset Formula $(i,\mathbf{j},e)\rightarrow(i,J)$
\end_inset

.
 This is done internally, but not in externally stored data, nor in xGRAPH,
 which operates on the full data arrays.
\end_layout

\begin_layout Standard
Stored data uses heterogenous cell arrays to package numerical arrays with
 additional high level indices.
 The first is always the sequence index, 
\begin_inset Formula $s$
\end_inset

.
 Raw data also requires indices for checks and high level ensembles.
 Inside a sequence, data cell arrays have an additional graph index 
\begin_inset Formula $n$
\end_inset

.
 This distinguishes the different averages generated for output graphs and
 data.
 
\end_layout

\begin_layout Standard
In summary, the xSPDE internal arrays are as follows:
\end_layout

\begin_layout Itemize

\series bold
Field
\series default
 arrays 
\begin_inset Formula $a(i,\bm{j}',e)$
\end_inset

 - these have a field index, a low-level ensemble index 
\begin_inset Formula $e=1,\ldots ensembles(1)$
\end_inset

, one time-point, and a full spatial lattice.
\end_layout

\begin_layout Itemize

\series bold
Random
\series default
 and 
\series bold
noise
\series default
 arrays 
\begin_inset Formula $w(i,\bm{j}',e)$
\end_inset

 - these are like field arrays.
 They are initial random fields or noise fields for the stochastic equations.
 The first index can have a different range to the field index.
\end_layout

\begin_layout Itemize

\series bold
Coordinate
\series default
 arrays 
\begin_inset Formula $x(1,\bm{j}',1)$
\end_inset

 - these arrays are the values of coordinates at grid-points, with labels
 
\begin_inset Formula $x,y,z$
\end_inset

.
 Numeric labels 
\begin_inset Formula $x\{l\}$
\end_inset

 are used with dimensions 
\begin_inset Formula $d>4$
\end_inset

, depending on the axis number, 
\begin_inset Formula $l=2,\ldots d$
\end_inset

.
 The same sizes are used for: 
\end_layout

\begin_deeper
\begin_layout Itemize
momentum coordinates 
\begin_inset Formula $kx,ky,kz$
\end_inset

 (alternatively labelled 
\begin_inset Formula $k\{2\},k\{3\},\ldots$
\end_inset

) - 
\end_layout

\begin_layout Itemize
spectral derivative arrays 
\begin_inset Formula $Dx,Dy,Dz$
\end_inset

 (alternatively labelled 
\begin_inset Formula $D\{2\},D\{3\},\ldots$
\end_inset

) .
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Raw
\series default
 arrays 
\begin_inset Formula $r\{s,c,h\}(i,\bm{j},e)$
\end_inset

 These are cell array of fields with all sequences, error-checking, trajectories
 and time points stored.
 They are used optionally, as they take up large amounts of memory.
 These are saved in cell arrays with indices 
\begin_inset Formula $s$
\end_inset

 for the sequence, 
\begin_inset Formula $c$
\end_inset

 for the time-step error-check and 
\begin_inset Formula $h$
\end_inset

 for high level ensemble index.
 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $s=1,\ldots S$
\end_inset

 for the sequence number, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $c=1,2$
\end_inset

 for the error-checking time-step used, first coarse then fine, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $h=1,\ldots ensemble(2)*ensemble(3)$
\end_inset

 for a high level combined parallel and serial ensemble index.
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Data
\series default
 arrays 
\begin_inset Formula $d\{g\}(\ell,\mathbf{j},c)$
\end_inset

 - these are first generated in xSIM by the observe functions, internally
 transformed if required, then passed to xGRAPH to store generated average
 data at all time points, with a 
\emph on
check
\emph default
 index 
\begin_inset Formula $c=1,2,3$
\end_inset

.
 Check indices are 
\begin_inset Formula $c=1$
\end_inset

 for the estimated average, 
\begin_inset Formula $c=2$
\end_inset

 for the estimated time-step error, and 
\begin_inset Formula $c=3$
\end_inset

 for the estimated statistical error or standard deviation.
 The cell index 
\begin_inset Formula $g$
\end_inset

 is the 
\emph on
graph
\emph default
 index, and the first array index 
\begin_inset Formula $\ell$
\end_inset

 is a user-generated graphics 
\emph on
line
\emph default
 index.
 This may or may not correspond to a field index: it is a user option.
\end_layout

\begin_layout Standard
Although the indices always occur in the same order, the fields, noises
 and output data can have different first dimensions.
 They are specified using different input parameters.
\end_layout

\begin_layout Subsection
Graphics data in xGRAPH
\end_layout

\begin_layout Standard
After averaging, the data no longer needs an ensemble index.
 However, averaged data uses an index in the same location, to specify the
 error bars.
 Similarly, the field index is replaced by a line index, which is used as
 the first index of averaged data to generate a different line on the graph.
 These are then combined into a sequence, each with multiple graphs, and
 therefore need more indices.
 
\end_layout

\begin_layout Itemize

\series bold
Graphics
\series default
 data arrays 
\begin_inset Formula $gd\{s\}\{g\}(\ell,\mathbf{j},c))$
\end_inset

 - these store the complete sequence of 
\emph on
data
\emph default
 that is plotted, and may even have further functional transformations when
 processed in xGRAPH, if required.
 Graphics cell data requires high-level cell indices 
\begin_inset Formula $\{s\}$
\end_inset

 for the 
\emph on
sequence
\emph default
 index, and 
\begin_inset Formula $\{g\}$
\end_inset

 for the 
\emph on
graph
\emph default
 index, which normally corresponds to the index 
\begin_inset Formula $\{g\}$
\end_inset

 of the observe function used to generate averages, unless the index was
 changed internally by an xSIM function.
 One can have several data arrays to make a number of distinct output graphs
 labelled 
\begin_inset Formula $g$
\end_inset

.
 Each graph may have multiple averages, giving different lines 
\begin_inset Formula $\ell$
\end_inset

 for comparisons.
 
\end_layout

\begin_layout Standard
The output line index 
\begin_inset Formula $o$
\end_inset

 in a graphics or data array describes different lines on a graph.
 Similarly, the last ensemble index 
\begin_inset Formula $e$
\end_inset

 in a field array has a different range to 
\begin_inset Formula $c$
\end_inset

, the check index, in a data array.
\end_layout

\begin_layout Subsection
Data indexing summary
\end_layout

\begin_layout Standard
The following detailed information is not required to use xSPDE, but it
 helps to give insight to how data is stored, and how to customize and extend
 the code.
 There are several different types of arrays used.
 These are as follows:
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Indices 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
a
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(i,\bm{j}',e)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stochastic fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
w
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(i,\bm{j}',e)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random and noise fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
x
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(1,\bm{j}',e)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space coordinates
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\{s,c,h\}(i,\bm{j},e)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Raw data
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
o
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 
\begin_inset Formula $\{g\}(\ell,\mathbf{j},c)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observed average data
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
g
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\{s\}\{g\}(\ell,\mathbf{j},c)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graph data
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Here: 
\end_layout

\begin_layout Itemize
\begin_inset Formula $i$
\end_inset

 is the field index, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\bm{j}$
\end_inset

 is the full time-space index, 
\begin_inset Formula $\bm{j}'$
\end_inset

 is the space index with a time index set to 
\begin_inset Formula $1$
\end_inset

, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $e$
\end_inset

 is the low-level ensemble or error index, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $s$
\end_inset

 is the sequence index, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $c$
\end_inset

 is the error-checking index,
\end_layout

\begin_layout Itemize
\begin_inset Formula $h$
\end_inset

 is the high-level ensemble index, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $g$
\end_inset

 is the graph index, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\ell$
\end_inset

 is the graphics line index.
\end_layout

\begin_layout Subsection
Step-size errors
\end_layout

\begin_layout Standard
Errors caused by the finite time-domain step-size, as well as those caused
 by the finite ensemble, are checked automatically.
 Those caused by the spatial lattice are not checked in the xSIM code.
 They must be checked by manually, by comparing results with different transvers
e lattice ranges and step-size.
\end_layout

\begin_layout Standard
Errors due to a finite step-size are estimated by comparing two simulations
 with different step-sizes and the same random sequence, to make sure the
 final results are accurate.
 The final 2D output graphs will have error-bars if 
\begin_inset Formula $checks=1$
\end_inset

 was specified, which is also the default parameter setting.
 Error-bars below a minimum relative size compared to the vertical range
 of the plot, specified by the graphics variable 
\begin_inset Formula $minbar$
\end_inset

, are not plotted.
 
\end_layout

\begin_layout Standard
There is a clear strategy if the errors are too large.
 Either increase the 
\emph on
points
\emph default
, which gives more plotted points and lower errors, or increase the 
\emph on
steps, 
\emph default
which reduces the step size without changing the graphical resolution.
 The default algorithm and extrapolation order can also be changed, please
 read the full xSPDE manual when doing this.
 Error bars on the graphs can be removed by setting 
\begin_inset Formula $checks=0$
\end_inset

 or increasing 
\begin_inset Formula $minbar$
\end_inset

 in final graphs.
\end_layout

\begin_layout Subsection
Sampling errors
\end_layout

\begin_layout Standard
Sampling error estimation in xSIM uses sub-ensemble averaging.
 This generally leads to more reliable sampling error estimates, and makes
 efficient use of the vector instruction sets that are used by Matlab.
 Ensembles are specified in three levels.
 The first, 
\emph on
ensemble(1)
\emph default
, is called the number of samples for brevity.
 All computed quantities returned by the 
\series bold
observe
\series default
 functions are first averaged over the samples, which are calculated efficiently
 using a parallel vector of trajectories.
 By the central limit theorem, these low-level sample averages are distributed
 as a normal distribution at large sample number.
\end_layout

\begin_layout Standard
Next, the sample averages are averaged 
\series bold
again
\series default
 over the two higher level ensembles, if specified.
 This time, the variance is accumulated.
 The variance of these distributions is used to estimate a standard deviation
 in the mean, since each computed quantity is now a normally distributed
 result.
 This method is applied to all the 
\emph on
graphs 
\emph default
observables.
 The two lines generated represent 
\begin_inset Formula $\bar{o}\pm\sigma$
\end_inset

, where 
\begin_inset Formula $o$
\end_inset

 is the observe function output, and 
\begin_inset Formula $\sigma$
\end_inset

 is the standard deviation in the mean.
\end_layout

\begin_layout Standard
The highest level ensemble, 
\emph on
ensemble(3), 
\emph default
is used for parallel simulations.
 This requires the Matlab parallel toolbox.
 Either type of high-level ensemble, or both together, can be used to calculate
 sampling errors.
\end_layout

\begin_layout Standard
Note that one standard deviation is not a strong bound; errors are expected
 to exceed this value in 
\begin_inset Formula $32\%$
\end_inset

 of observed measurements.
 Another point to remember is that stochastic errors are often correlated,
 so that a group of points may all have similar errors due to statistical
 sampling.
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $ensembles(2)>1$
\end_inset

 or 
\begin_inset Formula $ensembles(3)>1$
\end_inset

, which allows xSPDE to calculate sampling errors, it will plot upper and
 lower limits of one standard deviation.
 If the sampling errors are too large, try increasing 
\begin_inset Formula $ensembles(1)$
\end_inset


\emph on
, 
\emph default
which increases the trajectories in a single thread.
 An alternative is to increase 
\begin_inset Formula $ensembles(2)$
\end_inset

.
 This is slower, but is only limited by the compute time, or else to increase
 
\begin_inset Formula $ensembles(3)$
\end_inset

, which gives higher level parallelization.
 Each is limited in different ways; the first by memory, and the second
 by time, the third by the number of available cores.
 Sampling error control helps ensures accuracy.
\end_layout

\begin_layout Section
Graphics: 
\emph on
xGRAPH
\end_layout

\begin_layout Standard
The main functions involved for graphics are: 
\end_layout

\begin_layout Description
xGRAPH is called by xSPDE when the ensemble loops finished.
 The results are graphed and output if required.
 
\end_layout

\begin_layout Subsection
xGRAPH inputs
\end_layout

\begin_layout Standard
The input to 
\emph on
xGRAPH 
\emph default
can either come from a file, or it can be from data generated directly with
 
\emph on
xSIM
\emph default
.
 The data is a cell array, where each member of the cell array is a numerical
 graphics array, defining one independent set of averaged data.
 the observed data averages, stored in a cell array of size 
\begin_inset Formula $d\{n\}(o,\mathbf{j},c)$
\end_inset

.
 
\end_layout

\begin_layout Subsection
User definable graphics functions
\end_layout

\begin_layout Standard
It is possible to simply run 
\begin_inset Formula $\mathbf{xgraph}$
\end_inset

 as is, without much intervention.
 However, there are many customization options, including two user defined
 functions which have useful applications.
 These are as follows:
\end_layout

\begin_layout Description
*gfunction(d,r) is is a cell array of functions whose output is plotted.
 There is one graphics function for each multidimensional dataset that is
 plotted.
 The default value is just the average stored in the data array generated
 by the simulation observe function.
 
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

An arbitrary number of functions of these observables can also be plotted,
 including vector observables.
 The input to graphics functions is the observed data averages or functions
 of averages, stored in a cell array of size 
\begin_inset Formula $d\{n\}(o,\mathbf{j},c)$
\end_inset

.
 
\end_layout

\begin_layout Description
*compare(r) is a cell array of functions used to obtain comparison results.
 These are calculated from the user-specified 
\series bold
compare
\series default
 handle, giving a dashed line on the generated time-domain graphs, and an
 error summary which is printed.
 
\end_layout

\begin_layout Standard
The results from the two graphics functions plotted using the xGRAPH routines.
 
\end_layout

\begin_layout Subsection
xGRAPH outputs
\end_layout

\begin_layout Standard
This routine is prewritten to cover a range of useful graphs, but can be
 modified to suit the user.
 
\end_layout

\begin_layout Standard
The code will cascade down from higher to lower dimensions, generating different
 types of user-defined graphs.
 Each type of graph is generated once for each specified graphics function.
 The graphics axes that are used for plotting, and the points plotted, are
 defined using the optional 
\series bold
\emph on
axes 
\series default
\emph default
input parameters, where 
\begin_inset Formula $axes\{n\}$
\end_inset

 indicates the n-th specified graphics function or set of generated graphical
 data.
\end_layout

\begin_layout Standard
If there are no 
\series bold
\emph on
axes 
\series default
\emph default
inputs, or the inputs are zero - for example, 
\begin_inset Formula $axes\{1\}=\{0,0,0\}$
\end_inset

 - only the lowest dimensions are plotted, up to 3.
 If the 
\series bold
\emph on
axes 
\series default
\emph default
inputs project out a single point in a given dimension, - for example, 
\begin_inset Formula $axes\{1\}=\{0,31,-1,0\}$
\end_inset

, these axes are suppressed in the plots.
 This reduces the effective dimension of the data - in this case to two
 dimensions.
\end_layout

\begin_layout Standard
If the 
\begin_inset Formula $steps$
\end_inset

 option is used on input - for example 
\begin_inset Formula $steps=[2,3,4]$
\end_inset

, this adds additional integration points between the plotted points, to
 improve accuracy.
 These extra points are treated differently in space compared to time.
 The extra points in time are simply not stored or plotted, to conserve
 memory.
 Extra points in space are stored, in case greater detail is needed, but
 the default values of the 
\series bold
\emph on
axes 
\series default
\emph default
inputs are such that the intermediate points are skipped on plotting.
 This can be changed by using 
\series bold
\emph on
axes
\series default
\emph default
 inputs for more detail.
\end_layout

\begin_layout Standard
Examples:
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{1\}=\{0\}$
\end_inset

 - For function 1, plot all the time points; higher dimensions get defaults.
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{2\}=\{-1,0\}$
\end_inset

 - For function 2, plot the maximum time (the default), and all x-points.
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{3\}=\{1:4:51,32,64\}$
\end_inset

 - For function 3, plot every 4-th time point at x point 32, y point 64
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{4\}=\{0,2:4:48,0\}$
\end_inset

 - For function 4, plot every time point, every 4-th x point, and all y-points.
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $-1$
\end_inset

 indicates a default `typical' point, which is the last point on the time
 axis, and the midpoint on the other axes.
 The last example could also be achived in a simpler way, except it would
 be applied to all default axes, by using an input of:
\end_layout

\begin_layout Itemize
\begin_inset Formula $steps=[1,4,1]$
\end_inset

; 
\begin_inset Formula $points=[100,12,48]$
\end_inset

- plot all the t points; every 4th 
\emph on
x
\emph default
-point, and all the 
\emph on
y
\emph default
 points.
\end_layout

\begin_layout Standard
The 
\emph on
pdimension
\emph default
 input can also be used to reduce dimensionality, as this sets the maximum
 effective 
\emph on
plotted dimension
\emph default
.
 For example, 
\begin_inset Formula $pdimension\{1\}=1$
\end_inset

 means that only plots vs time are output for the first function plotted.
 Note that in the following, 
\begin_inset Formula $t,x,y,z$
\end_inset

 may be replaced by corresponding higher dimensions if there are 
\emph on
axes
\emph default
 that are suppressed.
 Slices can be taken at any desired point, not just the midpoint.
 Using the standard notation of, for example, 
\begin_inset Formula $axes\{1\}=\{6:3:81\}$
\end_inset

, can be used to modify the starting, interval, and finishing points for
 complete control on the plot points.
\end_layout

\begin_layout Standard
The graphics results depend on the resulting 
\series bold
effective
\series default
 dimension, which is equal to the actual space-time dimension unless there
 is an 
\emph on
axes
\emph default
 suppression, described above.
 Since the plot has to include a data axis, the plot itself will have an
 extra data axis, as well as the space-time lattice 
\emph on
dimension
\emph default
 axes.
 
\end_layout

\begin_layout Standard
We can plot only three axes directly using standard graphics tools.
 The strategy to deal with the higher dimensionality is as follows:
\end_layout

\begin_layout Description

\emph on
dimension=4..

\emph default
 For higher lattice dimensions, only a slice through the chosen point, or
 the default midpoint, is available, reducing the lattice dimension to 
\begin_inset Formula $3$
\end_inset

.
 
\end_layout

\begin_layout Description

\emph on
dimension=3
\emph default
 For three lattice dimensions, if 
\begin_inset Formula $images>1$
\end_inset

, a movie of distinct 3D graphic images of observable
\emph on
 vs x,y
\emph default
 are plotted as 
\begin_inset Formula $images$
\end_inset

 slices - usually in time.
 Otherwise, only a slice through the chosen point, or the default midpoint,
 is available for the highest dimension, reducing the lattice dimension
 to 
\begin_inset Formula $2$
\end_inset

.
 
\end_layout

\begin_layout Description

\emph on
dimension=2
\emph default
 For two lattice dimensions, one 3D image of observable
\emph on
 vs x,t
\emph default
 is plotted.
 A movie of distinct 2D graphic plots is also possible.
 Otherwise, only a slice through 
\begin_inset Formula $x=0$
\end_inset

 is available, reducing the lattice dimension to 
\begin_inset Formula $1$
\end_inset

.
 
\end_layout

\begin_layout Description

\emph on
dimension=1
\emph default
 For one lattice dimension, a 2D plot of observable
\emph on
 vs t
\emph default
 is plotted, with data at each lattice point in time.
 Exact results, error bars and sampling error bounds are included if available.
 
\end_layout

\begin_layout Standard
In addition to time-dependent graphs, the 
\series bold
xGRAPH
\series default
 function can generate 
\emph on
images 
\emph default
(3D)
\emph on
 
\emph default
and 
\emph on
transverse
\emph default
 (2D) plots at specified points in time, up to a maximum given by the number
 of time points specified.
 The number of these can be individually specified for each graphics output.
 The images available are specified as
\emph on
 imagetype
\emph default

\begin_inset Formula $=1,\ldots4$
\end_inset

, giving 3D perspective plots (the default), grey-scale colour plots, contour
 plots, and pseudo-color plots respectively.
\end_layout

\begin_layout Standard
Eerror bars, sampling errors and multiple lines are only graphed for 2D
 plots.
 Error-bars are not plotted when they are below a user-specified size, with
 a default of 
\begin_inset Formula $1\%$
\end_inset

 of the maximum range, to improve graphics quality.
 Higher dimensional graphs do not include this data, for visibility reasons,
 but they are still recorded in the data files.
 
\end_layout

\begin_layout Section
Architecture
\end_layout

\begin_layout Subsection
xSPDE data objects
\end_layout

\begin_layout Standard
The xSPDE data objects include parameters and methods, but with a very open
 type of object-oriented architecture to allow extensibility.
 All xSPDE functions are modular and easily replaceable.
 In many cases this is as easy as just defining a new function handle to
 replace the default value.
 To define your own integration function, include in the xSPDE input the
 line:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
r.
\family typewriter
step=@Mystep;
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Next, include anywhere on your Matlab path the function definition, for
 example:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function a = Mystep(a,w,r) 
\end_layout

\begin_layout Plain Layout

\family typewriter
% a = Mystep(a,w,r) propagates a step my way.
 
\end_layout

\begin_layout Plain Layout

\family typewriter
..
\end_layout

\begin_layout Plain Layout

\family typewriter
a = ...; 
\end_layout

\begin_layout Plain Layout

\family typewriter
end 
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
xSPDE hints
\end_layout

\begin_layout Itemize
When using xSPDE, it is a good idea to run the batch test script, Batchtest.m.
 
\end_layout

\begin_layout Itemize
Batchtest.m tests your parallel toolbox installation.
 If you have no license for this, omit the third ensemble setting.
\end_layout

\begin_layout Itemize
To create a project file, it is often easiest to start with an existing
 project function with a similar equation: see Examples folder.
\end_layout

\begin_layout Itemize
Graphics parameters can also be included in the structure 
\begin_inset Formula $\mathbf{in}$
\end_inset

, to modify graphs.
\end_layout

\begin_layout Itemize
Comparison functions can be included if you want to compare with analytic
 results.
\end_layout

\begin_layout Itemize
A full list of functionality is listed next.
\end_layout

\begin_layout Chapter
Metadata
\begin_inset CommandInset label
LatexCommand label
name "chap:Table-of-xSPDE"

\end_inset

 
\end_layout

\begin_layout Standard
The input data, which we label 
\begin_inset Formula $input$
\end_inset

, is a sequence of data structures that we label 
\begin_inset Formula $in$
\end_inset

.
 All of the input data is later passed to the 
\begin_inset Formula $xgraph$
\end_inset

 function.
 The input data can be numbers, vectors, strings, functions and cell arrays,
 which just lists of data enclosed in curly brackets, 
\begin_inset Formula $\{\}$
\end_inset

.
 All xSPDE metadata has preferred values, so only changes from the preferences
 need to be input.
 The resulting combined input including preferred values, is stored internally
 as a sequence of structures in a cell array to describe the simulation
 sequence.
\end_layout

\begin_layout Standard
Simulation metadata, including all preferred default values that were used
 in a particular simulation, is also stored in the xSPDE output files.
 This is done in both the Matlab 
\begin_inset Formula $.mat$
\end_inset

 and the HDF5 
\begin_inset Formula $.h5$
\end_inset

 output files, so the entire simulation can be easily reconstructed or changed.
 Note that in the current version of xSPDE, one must use a Matlab formatted
 
\begin_inset Formula $.mat$
\end_inset

 file to store raw data which includes all stochastic trajectories.
 Either the Matlab or the HDF5 files can be used to store both input and
 averaged output data.
\end_layout

\begin_layout Standard
Some conventions are used to simplify inputs, as follows: 
\end_layout

\begin_layout Itemize

\series bold
All input data has default values
\end_layout

\begin_layout Itemize

\series bold
Vector inputs of numbers are enclosed in square brackets, [...].
 
\end_layout

\begin_layout Itemize

\series bold
Where multiple inputs of strings, functions or vectors are needed they should
 be enclosed in curly brackets, {...}, to create a cell array.
 
\end_layout

\begin_layout Itemize

\series bold
Vector or cell array inputs with only one member don't require brackets.
 
\end_layout

\begin_layout Itemize

\series bold
Incomplete or partial vector or cell array inputs are filled in with the
 last applicable default value.
 
\end_layout

\begin_layout Itemize

\series bold
New function definitions can be handles pointing elsewhere.
\end_layout

\begin_layout Section
Simulation data
\end_layout

\begin_layout Standard
The simulation data of the 
\begin_inset Formula $in$
\end_inset

 structure is passed to the 
\begin_inset Formula $xsim$
\end_inset

 program, to define the simulation details.
 User application constants can be included, but must not be reserved names.
 However, names starting with '
\emph on
c
\emph default
' or any capital letter like 'A...' - except the reserved '
\emph on
D
\emph default
' for derivatives - are always available to users.
 Use of globals is 
\series bold
not
\series default
 recommended.
 It is incompatible with the Matlab parallel toolbox.
 Graphics data can be included, but it is simply stored for the graphics
 program to use.
\end_layout

\begin_layout Subsection
Simulation parameters
\end_layout

\begin_layout Standard
All simulation data has default values as distributed, which are also user-modif
iable through the
\emph on
 xpreferences
\emph default
 function.
 Any defaults can be checked by typing 
\begin_inset Formula $print=2$
\end_inset

, then running 
\emph on
xSIM(r)
\emph default
 or 
\emph on
xspde(r).

\emph default
 All parameters must be input as part of a structure passed to xSPDE.
 If multiple structures are passed, they are executed in sequence, with
 the output of the first simulation passed to the second, then the third,
 and so on.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="29" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
version
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
'xSIM3.2'
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Current version number
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
name
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
''
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simulation name
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dimension
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space-time dimension
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
fields
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[1,0]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of [integrated, defined] fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ranges
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[10,..]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Range of coordinates in [t,x,y,z,..]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
origin
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Origin of coordinates in [t,x,y,z,..]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
points
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
51 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output lattice points in [t,x,y,z,..]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
noises
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 0]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of noise fields in [x,k]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
randoms
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 0]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial random fields in [x,k]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ensembles
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ensembles used for averaging
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
steps
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Integration steps per output point
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
iterations
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
4
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum iterations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
order
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Extrapolation order 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
checks
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Check time-step errors?
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
seed
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Seed for random number generator
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
file
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
''
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
File-name: 
\emph on
'f.mat' 
\emph default
= Matlab
\emph on
, 'f.h5' 
\emph default
= HDF5 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
boundaries
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[0,0,0;0,0,0]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Boundary: '-1,0,1'=Neum,periodic,Dirich: per boundary.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
probability
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
Binning ranges for probabilities: see text
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ipsteps
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
2
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IP transforms per time-step
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
numberaxis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If 1, forces use of numerical axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
print
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print: 1 for medium, 2 for high output
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
- 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
User specified static parameters
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
olabels
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{'a_1',..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
averages
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of observables
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
transforms
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {[0 0 0 0],..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fourier transforms in [t,x,y,z,..] per observable
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
raw
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Raw data switch: 1 for raw output
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
scatters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {0,..}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify to obtain scatter plots, not averages
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
octave
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Force octave syntax: 1 for octave
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Common functions
\end_layout

\begin_layout Standard
The most common functions, output field dimensions and calling arguments,
 with user-definable functions marked using an asterisk, are:
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="25" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arguments 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Purpose
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*da
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
(a,z,r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stochastic derivative
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*initial
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
(v,r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Function to initialize fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*linear
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Linear derivative function
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*rfilter
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 
\emph default
(v,r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random filter function in k-space
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*nfilter
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(w,r)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Noise filter function in k-space
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*transfer
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
(v,r,a0,r0)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Transfer in sequence (returns a,r)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*step
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,z,dt,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Calculation of a time-step
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*grid
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $(r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Grid calculator for lattice
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*prop
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interaction picture propagator 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*propfactor
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(nc,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Propagator array calculation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*observe
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $(a,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable function cell array
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*function
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${@(av,~)av{1}(:,:,:).^{2},..}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Functions stored of averages
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*define
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,z,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defines an auxiliary field
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
randomgen
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial random generator
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
noisegen
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Noise generator
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rfilter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(v,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial random kspace filter
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
nfilter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w,(r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Noise kspace filter
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(o,[dx,]r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Integrates over a spatial lattice
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xbin
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(o,[dx,]r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bins results onto x-axis
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,dk,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Integrates over a reciprocal lattice
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xave
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,[av,]r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Averages over a spatial lattice
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xd
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,D,r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spectral spatial derivative
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xd1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,[dir,]r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1st derivative, finite diff.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xd2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(a,[dir,]r)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2nd derivative, finite diff.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
The arguments in square brackets are optional.
 For more details of use of integration and differentiation functions, see
 the user manual.
 In the case of the function 
\begin_inset Formula $xint$
\end_inset

, it is possible to integrate either with respect to 
\begin_inset Formula $dx$
\end_inset

 or 
\begin_inset Formula $dk$
\end_inset

, in either ordinary space or momentum space, by changing the the second
 argument passed to 
\begin_inset Formula $xint$
\end_inset

 as required.
 However, the fields that are passed to 
\begin_inset Formula $xint$
\end_inset

 must be transformed first.
 This happens automatically when the observe function is used with transforms
 selected.
\end_layout

\begin_layout Section
Internal data
\end_layout

\begin_layout Standard
Internally, xSPDE data is stored in a cell array, 
\begin_inset Formula $latt$
\end_inset

, of the data structures passed to functions.
 This includes the data given above from the input structures.
 In addition, it includes the computed parameters given below, which includes
 various internal array dimensions.
 The stochastic variable arrays like 
\begin_inset Formula $a,w,v$
\end_inset

 are internally flattened to become two-dimensional matrices where possible,
 to reduce dimensionality and simplify parallel operations.
 Momenta are stored in two grids.
 The propagation momentum grid is used while propagating, the graphics grid
 is used when averages are calculated and graphed.
\end_layout

\begin_layout Standard
For more than four total dimensions, the spatial grid, momentum grid and
 derivative grid notation of 
\emph on

\begin_inset Formula $t,x,y,z$
\end_inset

, 
\begin_inset Formula $\omega,kx,ky,kz$
\end_inset


\emph default
 and 
\emph on

\begin_inset Formula $Dx,Dy,Dz$
\end_inset


\emph default
 is changed to use numerical labels that correspond to the dimension numbers,
 i.e., 
\begin_inset Formula $x\{1\},\dots x\{d\}$
\end_inset

, 
\begin_inset Formula $k\{1\},\dots k\{d\}$
\end_inset

, 
\begin_inset Formula $D\{2\},\dots D\{d\}$
\end_inset

.
 These are simpler to handle with large numbers of space dimensions.
 This numeric labeling preference can be used even for lower dimensionality
 by setting the input switch 
\begin_inset Formula $numberaxis=1$
\end_inset

.
 The graph labels will use the same notation also, unless specified otherwise.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="36" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Typical value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
t 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Current value of time, t
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
w 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.6$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Frequency passed to in.observe : 
\begin_inset Formula $\omega$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $x,y,z$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space grid of
\begin_inset Formula $x,y,z$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $kx,ky,kz$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graphics momentum grid of 
\begin_inset Formula $k_{x},k_{y},k_{z}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $Dx,Dy,Dz$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Derivative grid of 
\begin_inset Formula $D_{x},D_{y},D_{z}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $r\{1\},\ldots r\{d\}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space grid of
\emph on

\begin_inset Formula $r_{1},\ldots r_{d}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $k\{1\},\ldots k\{d\}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graphics momentum grid of
\emph on
 
\begin_inset Formula $k_{1},\ldots k_{d}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $D\{2\},\ldots D\{d\}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Derivative grid of
\emph on
 
\begin_inset Formula $D_{2},\ldots D_{d}=i$
\end_inset


\begin_inset Formula $k_{1},\ldots ik_{d}$
\end_inset


\emph default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dx
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.2
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Steps in 
\begin_inset Formula $[t,x,y,z]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dk
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.6160
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Steps in 
\begin_inset Formula $[\omega,k_{x},k_{y},k_{z}]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dt
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.2000
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output time-step
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dtr
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.1000
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Reduced, internal time-step
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
v
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spatial lattice volume
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
kv
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Momentum lattice volume
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dv
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spatial cell volume
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dkv
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
1
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Momentum cell volume
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xc
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector cells 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{[0,...
 10]}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Space-time coordinate axes in 
\begin_inset Formula $[t,x,y,z]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
kc
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector cells 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{[0,..15,-15...]}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Computational axes in
\begin_inset Formula $[\omega,k_{x},k_{y},k_{z}]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
s.dx
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial stochastic normalization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
s.dxt
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
3.1623
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Propagating stochastic normalization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
s.dk
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial k stochastic normalization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
s.dkt
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
double 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
3.1623
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Propagating k stochastic normalization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
nspace
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
35 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of spatial lattice points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
nlattice
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3500 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total lattice: ensembles(1) x n.space 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ncopies
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ensembles(2) x ensembles(3)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
randoms
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of initial random fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
noises
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of noise fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.int
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for lattice integration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.a
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for 
\begin_inset Formula $a$
\end_inset

 field (flattened)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.r
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 [1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for coordinates (flattened)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.aplus
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for integrated plus defined fields
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.k
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[0 1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for noise transforms
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.obs
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1 1 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for observations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.data
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 3 51 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for average data (flattened)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
d.raw
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
[1 1 51 1]
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensions for raw data (flattened)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Section
Graphics data
\end_layout

\begin_layout Standard
The simulation data of the 
\begin_inset Formula $in$
\end_inset

 structure is also passed to the 
\begin_inset Formula $xgraph$
\end_inset

 program, along with optional graphics parameters for each observable, to
 create an extended graphics data structure.
 
\end_layout

\begin_layout Standard
These are all cell arrays when there is more than one type of graph or observabl
e, so that the graphics parameters can be individually set for each output
 that is plotted, using the cell index 
\begin_inset Formula $\{n\}$
\end_inset

 in a curly bracket.
 The axis labels, axis points and axis transformations of each graph are
 also cell arrays, as there can be any number of axes: so these are all
 nested cell arrays.
 If only a single input is specified, the cell index is automatically supplied.
 Graphics defaults are also user-modifiable by editing the
\emph on
 xgpreferences
\emph default
 function.
 
\end_layout

\begin_layout Standard
The plotted result can be an arbitrary function of the generated average
 data, by using the optional input
\emph on
 gfunctions.
 
\emph default
If this is omitted, the
\emph on
 
\emph default
generated average data from 
\begin_inset Formula $xsim$
\end_inset

 is plotted.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="18" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default value 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
gversion
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
'xGRAPH3.1'
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Current version number 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
in.olabels{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
'a'
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cell array of output data labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xlabels
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {'t' 'x' 'y' 'z'...}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Generic axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
klabels
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {'
\backslash
omega' 'k_x' 'k_y' 'k_z'...}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Transformed axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
minbar{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.01
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minimum relative error-bar 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*gfunction{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
@(d,~)
\begin_inset space ~
\end_inset

d{n} 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Functions plotted of averages
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
font{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Font size for graph labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
headers{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
'' 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graph headers
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
images{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of movie images 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
imagetype{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type of movie images 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
transverse{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of transverse plots 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
pdimension{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum plot dimensions 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*compare{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Comparison functions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
*xfunctions{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Axis transformations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
axes{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
{0,..} 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Points plotted for each axis
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
glabels{n}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
 {'t' 'x' 'y' 'z'}
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graph-specific axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
graphs
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
-
\emph default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of graphs
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Kiesewetter"
literal "true"

\end_inset

S.
 Kiesewetter, R.
 Polkinghorne, B.
 Opanchuk, and P.
 D.
 Drummond, 
\emph on
xSPDE: extensible software for stochastic equations
\emph default
, SoftwareX, March (2016).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Gardiner"
literal "true"

\end_inset

C.
 W.
 Gardiner, 
\emph on
Handbook of Stochastic Methods: for Physics, Chemistry and the Natural Sciences
\emph default
 (Springer 2004).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Drummond"
literal "true"

\end_inset

 P.
 D.
 Drummond and M.
 Hillery, 
\emph on
The Quantum Theory of Nonlinear Optics
\emph default
 (Cambridge University Press, Cambridge, 2014).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "DrummondMortimer"
literal "true"

\end_inset

P.
 D.
 Drummond and I.
 K.
 Mortimer, 
\emph on
Computer simulations of multiplicative stochastic differential equations.

\emph default
 J.
 Comp.
 Phys.
 
\series bold
93
\series default
, 144-170 (1991).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "KP"
literal "true"

\end_inset

P.E.
 Kloeden and E.
 Platen, 
\emph on
Numerical Solution of Stochastic Differential Equations
\emph default
 (Springer, 1995).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "WernerDrummond"
literal "true"

\end_inset

M.
 J.
 Werner and P.
 D.
 Drummond, 
\emph on
Robust algorithms for solving stochastic partial differential equations.

\emph default
 J.
 Comp.
 Phys.
 
\series bold
132
\series default
, 312-326 (1997).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Caradoc-Davies"
literal "true"

\end_inset

B.
 M.
 Caradoc-Davies, 
\emph on
Vortex dynamics in Bose-Einstein condensates
\emph default
 (Doctoral dissertation, PhD thesis, University of Otago (NZ), 2000).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "xmds"
literal "true"

\end_inset

 G.
 R.
 Collecutt, P.
 D.
 Drummond, 
\emph on
Xmds: eXtensible multi-dimensional simulator.

\emph default
 Comput.
 Phys.
 Commun.
 
\series bold
142
\series default
, 219-223 (2001).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "xmds2"
literal "true"

\end_inset

Graham R.
 Dennis, Joseph J.
 Hope, Mattias T.
 Johnsson, 
\emph on
XMDS2: Fast, scalable simulation of coupled stochastic partial differential
 equations,
\emph default
 Computer Physics Communications 
\series bold
184
\series default
, 201–208 (2013).
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "xmds-source"
literal "true"

\end_inset

http://sourceforge.net/projects/xmds/
\end_layout

\end_body
\end_document
